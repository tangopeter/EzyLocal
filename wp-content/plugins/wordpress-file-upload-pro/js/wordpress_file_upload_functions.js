function wfu_run_js_from_bank(){if("undefined"!=typeof WFU_JS_BANK)for(;WFU_JS_BANK.length>0;){var e=wfu_js_decode_obj(WFU_JS_BANK[0].obj_str);e&&e[WFU_JS_BANK[0].func].call(e),WFU_JS_BANK.splice(0,1)}}function wfu_Initialize_Consts(e){if(void 0===GlobalData.consts){GlobalData.consts=new Object;for(var a=e.split(";"),t=0;t<a.length;t++)const_txt=a[t].split(":"),GlobalData.consts[wfu_plugin_decode_string(const_txt[0])]=wfu_plugin_decode_string(const_txt[1])}}function wfu_Load_Code_Connectors(e){"undefined"==typeof wfu_Code_Objects&&(wfu_Code_Objects={}),wfu_Code_Objects[e]=new wfu_Code_Object(e);for(var a=0;a<Code_Initializators.length;a++)wfu_Code_Objects[e].additem(Code_Initializators[a](e))}function wfu_Code_Object(e){this.sid=e,this.items=[],this._calc_prioritized_list=function(e){for(var a,t,r=[],s=[],o=[],l=0;l<this.items.length;l++)(a=this.items[l])[e]&&(t=-1,a.priority&&(t=a.priority),a[e].priority&&(t=a[e].priority),t>=0?(r.push(t),s.push(l)):o.push(l));for(l=1;l<r.length;l++)for(var n=l;n<r.length;n++)if(r[n]<r[l-1]){var i=r[n];r[n]=r[l-1],r[l-1]=i,i=s[n],s[n]=s[l-1],s[l-1]=i}return s.concat(o)},this.additem=function(e){this.items.push(e)},this.apply_filters=function(e,a){if(void 0===a)return null;var t=this._calc_prioritized_list(e);if(0==t.length)return a;for(var r=0;r<t.length;r++){var s=this.items[t[r]],o=null;"function"==typeof s[e]?o=s[e]:"function"==typeof s[e].func&&(o=s[e].func),null!=o&&(a=o.apply(this,Array.prototype.slice.call(arguments,1)),arguments[1]=a)}return a},this.do_action=function(e){var a=this._calc_prioritized_list(e);if(0!=a.length)for(var t=0;t<a.length;t++){var r=this.items[a[t]],s=null;"function"==typeof r[e]?s=r[e]:"function"==typeof r[e].func&&(s=r[e].func),null!=s&&s.apply(this,Array.prototype.slice.call(arguments,1))}}}function wfu_plugin_load_action(e){var a=GlobalData.WFU[e];wfu_Code_Objects[e].do_action("pre_load"),wfu_install_unload_hook(),a.visualeditorbutton_exist&&(a.visualeditorbutton.init(),a.visualeditorbutton.attachInvokeHandler((function(){wfu_invoke_shortcode_editor(a)}))),a.is_formupload?a.uploadaction=function(){wfu_redirect_to_classic(e,0,0)}:a.uploadaction=function(){wfu_HTML5UploadFile(e)};var t=function(){wfu_selectbutton_clicked(e)};a.uploadform_exist&&a.uploadform.attachActions(t,(function(a){var t=GlobalData.WFU[e],r=0;t.is_formupload||(r=1),wfu_selectbutton_changed(e,r),wfu_update_uploadbutton_status(e),t.singlebutton&&a&&t.uploadaction()})),a.consent_exist&&(a.consent.attachActions((function(a){wfu_set_stored_formdata(e,"consentresult_"+e,a)})),a.consent.update("init")),a.submit_exist&&(t=a.testmode?function(){alert(GlobalData.consts.notify_testmode)}:function(){a.uploadaction()},a.submit.attachClickAction(t))}function wfu_install_unload_hook(){window.onbeforeunload=wfu_unload_hook}function wfu_unload_hook(){if(""!=GlobalData.UploadInProgressString&&""!=GlobalData.UploadInProgressString.trim())return GlobalData.consts.wfu_pageexit_prompt}function wfu_Check_Browser_Capabilities(){if("undefined"==typeof wfu_BrowserCaps){wfu_BrowserCaps=new Object;var e=wfu_GetHttpRequestObject();wfu_BrowserCaps.supportsAJAX=null!=e,wfu_BrowserCaps.supportsUploadProgress=!!(e&&"upload"in e&&"onprogress"in e.upload);var a=null;try{a=new FormData}catch(t){}wfu_BrowserCaps.supportsHTML5=null!=a;var t=document.createElement("iframe");wfu_BrowserCaps.supportsIFRAME=null!=t,wfu_BrowserCaps.supportsDRAGDROP=!!window.FileReader,wfu_BrowserCaps.supportsAnimation=wfu_check_animation(),wfu_BrowserCaps.supportsFileChunking=window.File&&!!(window.File.prototype.slice||window.File.prototype.mozSlice||window.File.prototype.webkitSlice),wfu_BrowserCaps.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0}}function wfu_check_animation(){var e=!1,a="Webkit Moz O ms Khtml".split(" "),t=document.createElement("DIV");if(t.style.animationName&&(e=!0),!1===e)for(var r=0;r<a.length;r++)if(void 0!==t.style[a[r]+"AnimationName"]){a[r].toLowerCase(),e=!0;break}return e}function wfu_join_strings(e){for(var a=[].slice.call(arguments),t="",r=1;r<a.length;r++)t+=(""==t||""==a[r]?"":e)+a[r];return t}function wfu_plugin_decode_string(e){for(var a,t,r=0,s="";r<e.length;)t=(a=parseInt(e.substr(r,2),16))<128?a:a<224?((31&a)<<6)+(63&parseInt(e.substr(r+=2,2),16)):((15&a)<<12)+((63&parseInt(e.substr(r+=2,2),16))<<6)+(63&parseInt(e.substr(r+=2,2),16)),s+=String.fromCharCode(t),r+=2;return s}function wfu_plugin_encode_string(e){var a=0,t="",r="";for(a=0;a<e.length;a++)num=e.charCodeAt(a),num>=2048?num=((16773120&num|917504)<<4)+((4032&num|8192)<<2)+(63&num|128):num>=128&&(num=((65472&num|12288)<<2)+(63&num|128)),1!=(r=num.toString(16)).length&&3!=r.length&&5!=r.length||(r="0"+r),t+=r;return t}function wfu_decode_array_from_string(e){var a=wfu_plugin_decode_string(e),t=null;try{t=JSON.parse(a)}catch(e){}return t}function wfu_randomString(e){for(var a=e,t="",r=0;r<a;r++){var s=Math.floor(61*Math.random());t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(s,s+1)}return t}function wfu_addEventHandler(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent?e.attachEvent("on"+a,t):e["on"+a]=t}function wfu_attach_element_handlers(e,a){for(var t=["DOMAttrModified","textInput","input","change","keypress","paste","focus","propertychange"],r=0;r<t.length;r++)wfu_addEventHandler(e,t[r],a)}function wfu_GetHttpRequestObject(){var e=null;try{e=new XMLHttpRequest}catch(a){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}if(null==e&&window.createRequest)try{xmlhttp=window.createRequest()}catch(e){}return e}function wfu_get_filelist(e,a){var t=GlobalData.WFU[e];a=void 0===a||a;var r=[];return t.uploadform_exist&&(r=t.uploadform.files()),a&&void 0!==t.filearray&&(r=t.filearray),r}function wfu_add_files(e,a){var t=GlobalData.WFU[e];void 0===t.filearray&&(t.filearray=Array(),t.filearrayprops=Array());var r=arguments.length>2&&arguments[2];r||t.uploadform_exist&&t.uploadform.reset(),r||(t.filearray.length=t.filearrayprops.length=0);for(var s=0;s<a.length;s++)t.filearray.push(a[s].file),t.filearrayprops.push(a[s].props)}function wfu_attach_cancel_event(e,a){function t(){var a=wfu_Initialize_Params();a.general.shortcode_id=e,a.general.unique_id="",a.general.files_count=0,a.general.state=16,wfu_ProcessUploadComplete(e,0,a,"no-ajax","",[!1,null,!1]),s.uploadform_exist&&(s.uploadform.reset(),s.uploadform.submit(),s.uploadform.lock())}function r(){var r=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_cancel_upload&wfu_uploader_nonce="+wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)+"&sid="+e+"&unique_id="+a+"&session_token="+GlobalData.WFU[e].session,s=wfu_GetHttpRequestObject();if(null==s){var o=document.createElement("iframe");if(o)return o.style.display="none",o.src=r,document.body.appendChild(o),void(o.onload=function(){t()})}s.open("GET",r,!0),s.onreadystatechange=function(){4==s.readyState&&200==s.status&&t()},s.send(null)}var s=GlobalData.WFU[e];if(s.filelist_exist){var o=wfu_get_filelist(e);s.filelist.attachCancelHandlers((function(t){if(s.is_formupload)r();else{if(!GlobalData[e])return;if(2==GlobalData[e].uploadflag[t])return;for(var l=null,n=0;n<GlobalData[e].xhrs.length;n++)if(GlobalData[e].xhrs[n].file_id==t+1){l=GlobalData[e].xhrs[n];break}null==l&&null!=(l=wfu_GetHttpRequestObject())&&wfu_initialize_fileupload_xhr(l,e,a,t,o[t].name),s.debugmode&&console.log("file "+(t+1)+" cancelled!");var i={target:{responseText:"force_cancel_code",shortcode_id:e}};wfu_uploadComplete.call(l,i)}}))}else s.textbox_exist&&s.textbox.attachCancelHandler((function(){var t=!1;if(s.is_formupload)1==(t=confirm(GlobalData.consts.cancel_upload_prompt))&&r();else{if(!GlobalData[e]||0==GlobalData[e].xhrs.length)return!1;if(1==(t=confirm(GlobalData.consts.cancel_upload_prompt))){for(var o=wfu_get_filelist(e),l=[],n=[],i=0;i<o.length;i++)l.push(null),n.push(o[i].name);for(i=0;i<GlobalData[e].xhrs.length;i++){var _=GlobalData[e].xhrs[i].file_id-1;_>=0&&2==GlobalData[e].uploadflag[_]&&(l[_]=-1,_=0),_>=0&&null==l[_]&&(l[_]=GlobalData[e].xhrs[i])}for(s.debugmode&&console.log("upload cancelled!"),i=0;i<l.length;i++)if(null==l[i]&&(l[i]=wfu_GetHttpRequestObject(),null!=l[i]&&wfu_initialize_fileupload_xhr(l[i],e,a,i,n[i])),-1!=l[i]){var u={target:{responseText:"force_cancel_code",shortcode_id:e}};wfu_uploadComplete.call(l[i],u)}for(i=0;i<GlobalData[e].uploadflag.length;i++)GlobalData[e].uploadflag[i]=2}}return t}))}function wfu_dettach_cancel_event(e){var a=GlobalData.WFU[e];a.filelist_exist&&a.filelist.dettachCancelHandlers(),a.textbox_exist&&a.textbox.dettachCancelHandler()}function wfu_selectbutton_changed(e,a){wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5||(a=0);var t=wfu_get_filelist(e,!1);if(1==a){void 0===GlobalData.WFU[e].filearray&&(GlobalData.WFU[e].filearray=Array(),GlobalData.WFU[e].filearrayprops=Array());for(var r=0;r<t.length;r++)GlobalData.WFU[e].filearray.push(t[r]),GlobalData.WFU[e].filearrayprops.push({from:"dialog"})}else void 0!==GlobalData.WFU[e].filearray&&(delete GlobalData.WFU[e].filearray,delete GlobalData.WFU[e].filearrayprops);wfu_update_filename_text(e),wfu_update_filelist(e),wfu_webcam_update_preview(e)}function wfu_selectbutton_clicked(e){var a=GlobalData.WFU[e];a.message_exist&&a.message.reset(),!a.multiple&&(a.uploadform_exist&&a.uploadform.reset(),wfu_filelist_clear(e))}function wfu_update_uploadbutton_status(e){var a=GlobalData.WFU[e];if(a.submit_exist){var t=a.submit,r=wfu_get_filelist(e);1==r.length?t.updateLabel(t.label_singular):r.length>1?t.updateLabel(t.label_plural):t.updateLabel(t.label_default);var s=r.length>0||a.allownofile;s=wfu_Code_Objects[e].apply_filters("uploadbutton_status",s),t.toggle(s)}}function wfu_update_filename_text(e){var a=GlobalData.WFU[e];if(a.textbox_exist){for(var t=wfu_get_filelist(e),r=[],s=0;s<t.length;s++)r.push(t[s].name);a.textbox.update("set",r)}}function wfu_init_userdata_handlers(e,a){var t=GlobalData.WFU[e],r=t.userdata.props[a],s=t.userdata.codes[a],o=t.userdata;s.init=function(){},s.value=function(){return""},s.lock=function(){},s.unlock=function(){},s.reset=function(){},s.empty=function(){return""},s.validate=null,s.typehook=null,"text"==r.type||"multitext"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):"number"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.typehook?s.typehook(e):r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){var e=/^(\+|\-)?[0-9]*$/i;return"f"==r.format&&(e=/^(\+|\-)?[0-9]*?\.?[0-9]*$/i),e.test(o.getValue(r))?"":o.error_invalid_number},s.typehook=function(e){var a=/^(\+|\-)?[0-9]*$/i;"f"==r.format&&(a=/^(\+|\-)?[0-9]*?\.?[0-9]*$/i),a.test(e.target.value)?r.store():e.target.value=r.getstored()}):"email"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){return""==o.getValue(r)||/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(o.getValue(r))?"":o.error_invalid_email}):"confirmemail"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){for(var e=null,a=0;a<t.userdata.props.length;a++)if(t.userdata.props[a]&&"email"==t.userdata.props[a].type&&t.userdata.props[a].group==r.group){e=t.userdata.props[a];break}return null!=e?o.getValue(r)==o.getValue(e)?"":o.error_confirm_email_nomatch:o.error_confirm_email_nobase}):"password"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):"confirmpassword"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){for(var e=null,a=0;a<t.userdata.props.length;a++)if(t.userdata.props[a]&&"password"==t.userdata.props[a].type&&t.userdata.props[a].group==r.group){e=t.userdata.props[a];break}return null!=e?o.getValue(r)==o.getValue(e)?"":o.error_confirm_password_nomatch:o.error_confirm_password_nobase}):"checkbox"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)?"true":"false"},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,"true"==r.default),r.store()},s.empty=function(){return o.getValue(r)?"":o.error_checkbox_notchecked}):"radiobutton"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_radio_notselected:""}):"date"==r.type||"time"==r.type||"datetime"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){def=r.default.trim(),"("==def.substr(0,1)&&")"==def.substr(def.length-1,1)?def=def.substr(1,def.length-2):def="",o.setValue(r,def),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):("list"==r.type||"dropdown"==r.type||"honeypot"==r.type)&&(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}),s.init()}function wfu_Redirect(e){window.location=e}function wfu_loadStart(e){}function wfu_update_upload_metrics(e){for(var a=0,t=0,r=0,s=Array(),o=wfu_get_filelist(e),l=0;l<o.length;l++)s[l]={size:o[l].size,aborted:!1,loaded:0,delta:0};for(l=0;l<GlobalData[e].xhrs.length;l++)(n=GlobalData[e].xhrs[l].file_id)>0&&GlobalData[e].xhrs[l].aborted&&s[n-1]&&(s[n-1].aborted=!0);for(l=0;l<GlobalData[e].xhrs.length;l++){var n;(n=GlobalData[e].xhrs[l].file_id)>0&&s[n-1]&&!s[n-1].aborted?(s[n-1].size=Math.max(GlobalData[e].xhrs[l].totalsize,s[n-1].size),s[n-1].loaded+=GlobalData[e].xhrs[l].sizeloaded,s[n-1].delta+=Math.max(GlobalData[e].xhrs[l].deltaloaded,0)):n>0&&s[n-1]&&s[n-1].aborted&&(s[n-1].hasOwnProperty("abort_metrics")||(s[n-1].abort_metrics={size:o[n-1].size,loaded:0,delta:0}),s[n-1].abort_metrics.size=Math.max(GlobalData[e].xhrs[l].totalsize,s[n-1].abort_metrics.size),s[n-1].abort_metrics.loaded+=GlobalData[e].xhrs[l].sizeloaded,s[n-1].abort_metrics.delta+=Math.max(GlobalData[e].xhrs[l].deltaloaded,0))}var i=(new Date).getTime();for(l=0;l<o.length;l++){var _=GlobalData[e].metrics[l];!s[l].aborted&&s[l].size>0?(_.size=s[l].size,"incremental"==GlobalData.consts.wfu_uploadprogress_mode?_.size-_.loaded!=0?_.progress_pos=Math.min(_.progress_pos+(1-_.progress_pos)*s[l].delta/(_.size-_.loaded),1):_.progress_pos=1:_.progress_pos=s[l].loaded/s[l].size,_.loaded=s[l].loaded,1==GlobalData[e].uploadflag[l]?(0==_.start_time&&(_.start_time=i),_.last_time=i):2==GlobalData[e].uploadflag[l]&&0==_.end_time&&(_.last_time=i,_.end_time=i),a+=_.size,t+=_.loaded,r+=s[l].delta):(_.size=0,_.progress_pos=0,_.loaded=0,s[l].aborted&&s[l].size>0&&!_.hasOwnProperty("abort_metrics")&&(_.last_time=0,_.aborted=!0,_.abort_metrics={size:s[l].abort_metrics.size,loaded:s[l].abort_metrics.loaded,abort_time:i}))}(_=GlobalData[e].metricstotal).size=a,"incremental"==GlobalData.consts.wfu_uploadprogress_mode?_.size-_.loaded!=0?_.progress_pos=Math.min(_.progress_pos+(1-_.progress_pos)*r/(_.size-_.loaded),1):_.progress_pos=1:_.progress_pos=t/a,_.loaded=t,_.last_time=i}function wfu_uploadProgress(e,a,t,r){var s=GlobalData.WFU[a];r&&void 0===this.xhr&&(console.log("total="+e.total+", loaded="+e.loaded),console.log(e));var o=GlobalData[a].xhrs[t];if(0!=o.file_id){var l=0,n=0,i=!!s.progressbar_exist;if(o.chunk_id>0){var _=new Date;GlobalData[a].chunkedfile[o.file_id-1].lasttime[o.chunk_id-1]=_.getTime()}var u=!!s.filelist_exist;if(e.lengthComputable){if(o.deltaloaded=e.loaded-o.sizeloaded,o.sizeloaded=e.loaded,o.size<e.total&&e.total>0){n=e.total-o.size,o.deltasize+=n,o.size+=n;for(var d=0;d<GlobalData[a].xhrs.length;d++)GlobalData[a].xhrs[d].file_id==o.file_id&&(GlobalData[a].xhrs[d].totalsize+=n)}if(wfu_update_upload_metrics(a),o.deltaloaded=0,u){var c=GlobalData[a].metrics[o.file_id-1],f=-1;for(d=0;d<GlobalData[a].xhrs.length;d++)if(GlobalData[a].xhrs[d]==o){f=d;break}r&&console.log("i="+f+", size="+o.size+", totalsize="+o.totalsize+", delta="+n+", total="+c.size+", loaded="+c.loaded),l=Math.round(100*c.progress_pos),s.filelist.updateItemProgress(o.file_id-1,l),l=Math.round(100*GlobalData[a].metricstotal.progress_pos),s.filelist.updateTotalProgress(l)}i&&(l=Math.round(100*GlobalData[a].metricstotal.progress_pos),s.progressbar.update(l))}else u&&s.filelist.updateTotalProgress(0),i&&s.progressbar.update(0)}}function wfu_notify_WPFilebase(e,a){var t=wfu_GetHttpRequestObject();if(null==t)return(o=document.createElement("iframe")).style.display="none",o.src=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_notify_wpfilebase&params_index="+e+"&session_token="+a,void document.body.appendChild(o);var r=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_notify_wpfilebase",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=e,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=a;for(var s="",o=0;o<params.length;o++)s+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);t.open("POST",r,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){},t.send(s)}function wfu_send_email_notification(e,a){var t=GlobalData.WFU[e],r=wfu_GetHttpRequestObject();if(null!=r){var s=GlobalData.consts.ajax_url;params=new Array(4),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_send_email_notification",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=t.params_index,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=t.session,params[3]=new Array(2),params[3][0]="uniqueuploadid_"+e,params[3][1]=a;for(var o="",l=0;l<params.length;l++)o+=(l>0?"&":"")+params[l][0]+"="+encodeURI(params[l][1]);wfu_initialize_fileupload_xhr(r,e,a,-1,""),r.success_message_header="",r.error_message_header="",r.error_adminmessage_unknown="",r.open("POST",s,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.addEventListener("load",wfu_uploadComplete,!1),r.addEventListener("error",wfu_uploadFailed,!1),r.addEventListener("abort",wfu_uploadCanceled,!1),r.send(o)}}function wfu_uploadComplete(e){var a=new Date,t=this.shortcode_id,r=GlobalData.WFU[t],s=this.file_id,o=!1,l="",n="",i="",_="unknown",u="",d=null;this.loading=!1,this.end_time=a.getTime();var c=e.target.responseText,f=c,p="error";if(-1!=c&&(c.indexOf("force_errorabort_code")>-1&&(p="errorabort",c=c.replace("force_errorabort_code","")),c.indexOf("force_cancel_code")>-1&&(p="errorcancel",c=c.replace("force_cancel_code","")),c.indexOf("force_abortsuccess_code")>-1&&(p="errorabortsuccess",c=c.replace("force_abortsuccess_code",""))),-1!=c){var w=c.indexOf("wfu_fileupload_success:"),m="";if(w>-1&&(r.debugmode&&(m=c.substr(0,w)),w=(f=c.substr(w+23)).indexOf(":"),l=f.substr(0,w),w=(f=f.substr(w+1)).indexOf(":"),i=f.substr(0,w),n=f.substr(w+1)),""!=m){var b="";"fileupload"==this.requesttype?b="Debug Data - File: "+this.file_id:"email"==this.requesttype&&(b="Debug Data - Email Notification"),this.chunk_id>0&&(b+=", Chunk: "+this.chunk_id),d={title:b,data:m}}if(""!=i){var g=i.split(";");if(1==parseInt(g[2])){var h=g[3].split(",");_=wfu_plugin_decode_string(h[0]),u=h[4]}}}if(""==n||""==i){var v=wfu_Initialize_Params();v.general.shortcode_id=t,v.general.unique_id=this.unique_id,v.general.state=7,v.general.files_count="fileupload"==this.requesttype?1:0,v.general.upload_finish_time=this.finish_time;var y=r.fail_colors.split(","),G=this.error_message_header,x=p;"errorabortsuccess"==p?(v.general.fail_message="",v.general.fail_admin_message="",y=r.success_colors.split(","),G=this.success_message_header,x="success"):"errorcancel"!=p?(v.general.fail_message=GlobalData.consts.message_unknown,v.general.fail_admin_message=wfu_join_strings("<br />",this.error_adminmessage_unknown,this.requesttype+":"+f)):(v.general.fail_message=GlobalData.consts.file_cancelled,v.general.fail_admin_message=""),v.general.files_count>0?(v[0]={},v[0].color=y[0],v[0].bgcolor=y[1],v[0].borcolor=y[2],v[0].message_type=x,_=p,v[0].header=G,v[0].message=GlobalData.consts.message_timelimit,v[0].admin_messages=r.is_admin?GlobalData.consts.message_admin_timelimit:""):v.general.admin_messages.other=r.is_admin?GlobalData.consts.message_admin_timelimit:"",v.general.upload_finish_time>0&&a.getTime()<v.general.upload_finish_time&&(v.general.files_count>0?(v[0].message=v.general.fail_message,v[0].admin_messages=r.is_admin?v.general.fail_admin_message:""):v.general.admin_messages.other=r.is_admin?v.general.fail_admin_message:"")}if("error"==_.substr(0,5)){if(this.chunk_id>0&&0==s)return void(r.debugmode&&console.log("rejected xhr "+this.xhrid+" returned "+_+" message"));if(this.chunk_id>0&&"error"==_&&(GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]++,-1==GlobalData.consts.wfu_repeated_chunk_fails||GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]<=GlobalData.consts.wfu_repeated_chunk_fails))return wfu_chunk_reset(this),void(r.debugmode&&console.log("repeating chunk "+this.chunk_id+" for "+GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]+" times"));for(var D=0;D<GlobalData[t].xhrs.length;D++)GlobalData[t].xhrs[D].file_id==s&&(GlobalData[t].xhrs[D].aborted=!0,GlobalData[t].xhrs[D].abort(),GlobalData[t].xhrs[D].sizeloaded=GlobalData[t].xhrs[D].size,r.debugmode&&console.log("upload aborted for file "+this.file_id+" and chunk "+this.chunk_id))}else if(this.chunk_id>0){if(0==s)return void(r.debugmode&&console.log("rejected xhr "+this.xhrid+" returned success message"));GlobalData[t].chunkedfile[s-1].uploadflag[this.chunk_id-1]=2}"error"==_.substr(0,5)&&(_=_.substr(0,5));var k=!1;if(this.chunk_id>0){for(k=!0,D=0;D<GlobalData[t].chunkedfile[s-1].uploadflag.length;D++)if(GlobalData[t].chunkedfile[s-1].uploadflag[D]<2){k=!1;break}k=k||"error"==_}else k=this.totalsize>0||"error"==_;if(k&&(GlobalData[t].uploadflag[s-1]=2,wfu_update_upload_metrics(t),r.debugmode&&console.log("completed file: "+s+" status: "+_),r.filelist_exist&&r.filelist.updateItemStatus(s-1,_),""!=u)){u=wfu_plugin_decode_string(u.replace(/^\s+|\s+$/g,""));var U=null;try{U=JSON.parse(u)}catch(e){}if(null!=U){var F=U.user,P=document.querySelectorAll(".wfu_browser_id");for(D=0;D<P.length;D++){var C=P[D].value;"0"==F&&(U.user=document.getElementById("wfu_browser_guesttitle_"+C).value,U.user_sort=U.user),wfu_browser_reload(C,!1)}}}if(""==n||""==i?(r.debugmode&&console.log("wfu_ProcessUploadComplete: ",t,this.file_id,"Params obj",this.unique_id,"",[r.debugmode,d,r.is_admin],this.requesttype,""),o=wfu_ProcessUploadComplete(t,this.file_id,v,this.unique_id,"",[r.debugmode,d,r.is_admin],this.requesttype,"")):(r.debugmode&&console.log("wfu_ProcessUploadComplete: ",t,this.file_id,"Params str",this.unique_id,i,[r.debugmode,d,r.is_admin],this.requesttype,l),o=wfu_ProcessUploadComplete(t,this.file_id,n,this.unique_id,i,[r.debugmode,d,r.is_admin],this.requesttype,l)),o&&(wfu_dettach_cancel_event(t),wfu_unlock_upload(t),r.progressbar_exist&&r.progressbar.hide(),wfu_clear(t)),e.target.return_status)return _}function wfu_ProcessUploadComplete(sid,file_id,upload_params,unique_id,safe_output,debug_data,request_type,js_script_enc){var WFU=GlobalData.WFU[sid];if(sid&&!(sid<0)&&null!=upload_params&&""!=upload_params&&""!=unique_id&&("no-ajax"==unique_id||GlobalData[sid])){var do_redirect=!1;if("string"==typeof upload_params){upload_params=wfu_plugin_decode_string(upload_params.replace(/^\s+|\s+$/g,""));var Params=null;try{Params=JSON.parse(upload_params)}catch(e){}if(null==Params){var safe_parts=safe_output.split(";");Params=wfu_Initialize_Params(),Params.general.shortcode_id=sid,Params.general.unique_id=unique_id,Params.general.state=safe_parts[0],4==Params.general.state&&Params.general.state++;var default_colors=safe_parts[1].split(","),filedata="",error_jsonparse_filemessage=GlobalData.consts.jsonparse_filemessage,error_jsonparse_message=GlobalData.consts.jsonparse_message,error_jsonparse_adminmessage=GlobalData.consts.jsonparse_adminmessage;Params.general.files_count=parseInt(safe_parts[2]);for(var i=0;i<Params.general.files_count;i++)Params[i]={},Params[i].color=default_colors[0],Params[i].bgcolor=default_colors[1],Params[i].borcolor=default_colors[2],filedata=safe_parts[i+3].split(","),Params[i].message_type=wfu_plugin_decode_string(filedata[0]),Params[i].header=wfu_plugin_decode_string(filedata[1]),"success"==Params[i].message_type&&(Params[i].header+=error_jsonparse_filemessage,Params[i].message_type="warning"),Params[i].message=wfu_join_strings("<br />",error_jsonparse_message,wfu_plugin_decode_string(filedata[2])),Params[i].admin_messages=wfu_join_strings("<br />",error_jsonparse_adminmessage,wfu_plugin_decode_string(filedata[3]))}}else{if("object"!=typeof upload_params)return;var Params=upload_params}WFU.debugmode&&console.log("wfu_ProcessUploadComplete debug: ",debug_data),WFU.debugmode&&console.log("wfu_ProcessUploadComplete Params: ",Params);var message_types=[];for(i=0;Params[i];)Params[i].message_type&&(message_types.push(Params[i].message_type),"error"==Params[i].message_type.substr(0,5)&&(Params[i].message_type=Params[i].message_type.substr(0,5))),i++;GlobalData[sid]||(GlobalData[sid]=Object());var G=GlobalData[sid];if("no-ajax"==unique_id)G.last=!1,G.unique_id="",G.files_count=Params.general.files_count,0==Params.general.state&&(Params.general.files_count=0),G.files_processed=Params.general.files_count,G.upload_state=Params.general.state,G.nofileupload=Params.general.state>12&&Params.general.state<16,"message"in G||(G.message=[]),""!=Params.general.message?G.message.push(Params.general.message):G.message=[],G.update_wpfilebase=Params.general.update_wpfilebase,G.redirect_link=Params.general.redirect_link,G.notify_by_email=0,G.admin_messages={},G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase,G.admin_messages.notify=Params.general.admin_messages.notify,G.admin_messages.redirect=Params.general.admin_messages.redirect,"debug"in G.admin_messages||(G.admin_messages.debug=[]),null!==debug_data[1]&&G.admin_messages.debug.push(debug_data[1]),"other"in G.admin_messages||(G.admin_messages.other=[]),""!=Params.general.admin_messages.other&&G.admin_messages.other.push(Params.general.admin_messages.other),G.errors={},G.errors.wpfilebase=Params.general.errors.wpfilebase,G.errors.notify=Params.general.errors.notify,G.errors.redirect=Params.general.errors.redirect,G.current_size=0,G.total_size=0;else{if(""==G.unique_id||G.unique_id!=unique_id||G.unique_id!=Params.general.unique_id)return;if(G.last)return;0==Params.general.files_count&&Params[0]?("error"==Params[0].message_type&&(Params.general.files_count=1),G[file_id-1]||(G[file_id-1]={}),("success"==G[file_id-1].message_type&&"success"!=Params[0].message_type||"warning"==G[file_id-1].message_type&&"error"==Params[0].message_type||!G[file_id-1].message_type)&&(G[file_id-1].message_type=Params[0].message_type,G[file_id-1].header=Params[0].header,G[file_id-1].color=Params[0].color,G[file_id-1].bgcolor=Params[0].bgcolor,G[file_id-1].borcolor=Params[0].borcolor,""!=Params[0].message&&(G[file_id-1].message=Params[0].message),""!=Params[0].admin_messages&&(G[file_id-1].admin_messages=Params[0].admin_messages))):1==Params.general.files_count&&G[file_id-1]&&("success"==Params[0].message_type&&"success"!=G[file_id-1].message_type||"warning"==Params[0].message_type&&"error"==G[file_id-1].message_type)&&(Params[0].message_type=G[file_id-1].message_type,Params[0].header=G[file_id-1].header,Params[0].color=G[file_id-1].color,Params[0].bgcolor=G[file_id-1].bgcolor,Params[0].borcolor=G[file_id-1].borcolor,""!=G[file_id-1].message&&(Params[0].message=G[file_id-1].message),""!=G[file_id-1].admin_messages&&(Params[0].admin_messages=G[file_id-1].admin_messages));for(var file_status="",i=0;i<Params.general.files_count;i++)file_status="error"==Params[i].message_type&&0==G.files_processed?"error1":"error"==Params[i].message_type&&G.files_processed>0?"error2":Params[i].message_type,G.upload_state=GlobalData.filestatematch[file_status][G.upload_state];G.files_processed+=Params.general.files_count,""!=Params.general.message&&G.message.push(Params.general.message),""==G.update_wpfilebase&&(G.update_wpfilebase=Params.general.update_wpfilebase),(!request_type||request_type&&"email"!=request_type)&&(G.redirect_link=Params.general.redirect_link),G.notify_by_email+=parseInt("0"+Params.general.notify_by_email),null!==debug_data[1]&&G.admin_messages.debug.push(debug_data[1]),""!=Params.general.admin_messages.other&&G.admin_messages.other.push(Params.general.admin_messages.other),""==G.admin_messages.wpfilebase&&(G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase),""==G.admin_messages.notify&&(G.admin_messages.notify=Params.general.admin_messages.notify),""==G.admin_messages.redirect&&(G.admin_messages.redirect=Params.general.admin_messages.redirect),""==G.errors.wpfilebase&&(G.errors.wpfilebase=Params.general.errors.wpfilebase),""==G.errors.notify&&(G.errors.notify=Params.general.errors.notify),""==G.errors.redirect&&(G.errors.redirect=Params.general.errors.redirect)}G.files_processed==G.files_count&&(G.last=!0,""!=G.update_wpfilebase&&(G.admin_messages.wpfilebase="",wfu_notify_WPFilebase(WFU.params_index,WFU.session)),G.notify_by_email>0&&(G.admin_messages.notify="",wfu_send_email_notification(sid,unique_id),G.last=!1,G.notify_by_email=0),G.last&&(GlobalData[sid].metricstotal&&(GlobalData[sid].metricstotal.end_time=(new Date).getTime()),"no-ajax"==unique_id||G.nofileupload||wfu_notify_server_upload_ended(sid,unique_id),GlobalData.UploadInProgressString=GlobalData.UploadInProgressString.replace(new RegExp("\\["+unique_id+"\\]","g"),"")),""!=G.errors.redirect&&(G.redirect_link=""),""!=G.redirect_link&&G.last&&""==GlobalData.UploadInProgressString.trim()&&(G.upload_state=11,do_redirect=!0));var nonadmin_message=G.message,admin_message=[].concat(G.admin_messages.other,""!=G.admin_messages.wpfilebase?[G.admin_messages.wpfilebase]:[],""!=G.admin_messages.notify?[G.admin_messages.notify]:[],""!=G.admin_messages.redirect?[G.admin_messages.redirect]:[]);if(G.last&&(G.nofileupload?("no-ajax"!=unique_id&&(0==G.upload_state?G.upload_state=14:G.upload_state<4&&(G.upload_state=15)),15==G.upload_state&&Params[0]&&(nonadmin_message.push(Params[0].message),admin_message.push(Params[0].admin_messages))):(G.files_count>0&&G.store_nothing&&G.upload_state<3&&(G.upload_state=19),0==G.files_count&&12!=G.upload_state&&G.upload_state<16?G.upload_state=8:G.upload_state<4&&(G.upload_state+=4),4==G.upload_state&&admin_message.length>0?G.upload_state++:5==G.upload_state&&0==admin_message.length&&0==nonadmin_message.length&&G.upload_state--)),WFU.message_exist){var suffix="";1!=G.files_count||5!=G.upload_state&&7!=G.upload_state||(suffix="_singlefile");for(var final_upload_state=0==G.upload_state&&G.nofileupload?13:G.upload_state,data={files_count:G.nofileupload?0:G.files_count,files_processed:G.nofileupload?0:G.files_processed,state:final_upload_state,single:1==G.files_count&&0==nonadmin_message.length&&0==admin_message.length&&G.last&&!do_redirect&&!G.nofileupload,color:GlobalData.States["State"+final_upload_state+suffix].color,bgcolor:GlobalData.States["State"+final_upload_state+suffix].bgcolor,borcolor:GlobalData.States["State"+final_upload_state+suffix].borcolor,message1:GlobalData.States["State"+final_upload_state+suffix].message,message2:nonadmin_message,message3:admin_message,debug_data:G.admin_messages.debug,files:[]},i=0;i<Params.general.files_count;i++)data.files[i]={index:i+file_id,result:Params[i].message_type,message1:Params[i].header,message2:Params[i].message,message3:Params[i].admin_messages};WFU.message.update(data)}return js_script_enc&&eval(wfu_plugin_decode_string(js_script_enc)),do_redirect&&wfu_Redirect(G.redirect_link),G.last}}function wfu_uploadFailed(e,a){a&&(console.log("failure report following"),console.log(e));var t=e.target,r={target:{responseText:"",shortcode_id:t.shortcode_id}};wfu_uploadComplete.call(t,r)}function wfu_uploadCanceled(e){}function wfu_notify_server_upload_ended(e,a){var t=GlobalData.WFU[e],r=wfu_GetHttpRequestObject();if(null!=r){var s=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action",params[1]=new Array(2),params[1][0]="wfu_uploader_nonce",params[1][1]=wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e),params[2]=new Array(2),params[2][0]="uniqueuploadid_"+e,params[2][1]=a,params[3]=new Array(2),params[3][0]="params_index",params[3][1]=t.params_index,params[4]=new Array(2),params[4][0]="session_token",params[4][1]=t.session,params[5]=new Array(2),params[5][0]="upload_finished",params[5][1]=1;for(var o="",l=0;l<params.length;l++)o+=(l>0?"&":"")+params[l][0]+"="+encodeURI(params[l][1]);r.open("POST",s,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){4==r.readyState&&200==r.status&&wfu_Code_Objects[e].do_action("after_upload",r.responseText)},r.send(o)}}function wfu_Initialize_Params(){var e={version:"full",general:{}};return e.general.shortcode_id=0,e.general.unique_id="",e.general.state=0,e.general.files_count=0,e.general.update_wpfilebase="",e.general.redirect_link="",e.general.upload_finish_time=0,e.general.message="",e.general.message_type="",e.general.admin_messages={},e.general.admin_messages.wpfilebase="",e.general.admin_messages.notify="",e.general.admin_messages.redirect="",e.general.admin_messages.other="",e.general.errors={},e.general.errors.wpfilebase="",e.general.errors.notify="",e.general.errors.redirect="",e.general.color="",e.general.bgcolor="",e.general.borcolor="",e.general.notify_by_email=0,e.general.fail_message="",e.general.fail_admin_message="",e}function wfu_redirect_to_classic(e,a,t){var r=GlobalData.WFU[e];r.is_formupload=!0;var s=!1;if(void 0!==r.filearray){farrprops=r.filearrayprops;for(var o=0;o<farrprops.length;o++)if("dragdrop"==farrprops[o].from){s=!0;break}s&&(r.uploadform_exist&&r.uploadform.reset(),wfu_filelist_clear(e),alert(GlobalData.consts.redirection_nodragdrop))}var l=wfu_filesselected(e);(0!=l||r.allownofile)&&(r.subfolders_exist&&l>0&&!r.subfolders.check()||wfu_check_required_userdata(e,!0)&&wfu_Code_Objects[e].apply_filters("pre_start_check",!0)&&wfu_redirect_to_classic_cont(e,a,t))}function wfu_redirect_to_classic_cont(e,a,t){var r=function(r){var o=GlobalData.WFU[e],l="",n=(o.session,"wfu_askserver_success:"),i=r.indexOf(n),_=r.indexOf("wfu_askserver_error:");if(i>-1){l=r.substr(i+22);var u=wfu_filesselected(e),d=0==u&&o.allownofile;wfu_Code_Objects[e].do_action("askserver_success",l,"no-ajax"),o.progressbar_exist&&!d&&o.progressbar.show("shuffle"),o.filelist_exist&&(o.filelist.afterUploadStart("shuffle",!0),o.filelist.setVisibility(!0)),wfu_attach_cancel_event(e,s);var c=wfu_Initialize_Params();c.general.shortcode_id=e,c.general.unique_id="",c.general.files_count=u,d&&(c.general.state=13),wfu_ProcessUploadComplete(e,0,c,"no-ajax","",[!1,null,!1]),wfu_set_stored_formdata(e,"uniqueuploadid_"+e,s),wfu_set_stored_formdata(e,"nofileupload_"+e,d?"1":"0");var f="";o.multiple&&(f="[]");var p="";1==a&&(p="_redirected"),o.uploadform_exist&&o.uploadform.changeFileName("uploadedfile_"+e+p+f),wfu_set_stored_formdata(e,"adminerrorcodes_"+e,t>0?t:""),o.uploadform_exist&&(o.uploadform.submit(),o.uploadform.lock())}else _>-1&&(l=r.substr(_+20),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_error",l))},s=wfu_randomString(10);wfu_lock_upload(e),wfu_Code_Objects[e].do_action("pre_start");var o="",l=wfu_Code_Objects[e].apply_filters("askserver_pass_params",{});for(var n in l)l.hasOwnProperty(n)&&(o+="&"+n+"="+l[n]);var i=new Date,_=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_ask_server&wfu_uploader_nonce="+wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)+"&sid="+e+"&unique_id="+s+"&start_time="+i.getTime()+"&session_token="+GlobalData.WFU[e].session+o,u=wfu_GetHttpRequestObject();if(null==u){var d=document.createElement("iframe");return d?(d.style.display="none",d.src=_,document.body.appendChild(d),void(d.onload=function(){r(d.contentDocument.body.innerHTML)})):void wfu_Code_Objects[e].do_action("not_supported")}u.open("GET",_,!0),u.onreadystatechange=function(){4==u.readyState&&(200==u.status?r(u.responseText):(alert(GlobalData.consts.remoteserver_noresult),wfu_Code_Objects[e].do_action("askserver_noresult")))},u.send(null)}function wfu_filesselected(e){var a=GlobalData.WFU[e],t=wfu_get_filelist(e);return 0==t.length&&!a.allownofile&&a.textbox_exist&&a.textbox.update("nofile"),t.length}function wfu_get_stored_formdata(e,a){var t=GlobalData.WFU[e];return t.uploadform_exist?t.uploadform.getStoreddata?t.uploadform.getStoreddata(a):document.getElementById(a).value:null}function wfu_set_stored_formdata(e,a,t){var r=GlobalData.WFU[e];if(!r.uploadform_exist)return null;r.uploadform.setStoreddata?r.uploadform.setStoreddata(a,t):document.getElementById(a).value=t}function wfu_check_required_userdata(e,a){for(var t=GlobalData.WFU[e],r=wfu_get_userdata_count(e),s=!1,o=0;o<r;o++){t.userdata.props[o].store();var l="";t.userdata.props[o].required&&(l=t.userdata.codes[o].empty()),""===l&&null!=t.userdata.codes[o].validate&&t.userdata.props[o].validate&&(l=t.userdata.codes[o].validate()),""!==l&&(a&&t.userdata.prompt(t.userdata.props[o],l),s=!0)}return!s}function wfu_HTML5UploadFile(e){var a=GlobalData.WFU[e];if(wfu_BrowserCaps.supportsAJAX)if(wfu_BrowserCaps.supportsHTML5){var t=wfu_GetHttpRequestObject();if(null!=t){var r=wfu_filesselected(e);if(0!=r||a.allownofile)if(0==r&&wfu_selectbutton_clicked(e),a.subfolders_exist&&r>0&&!a.subfolders.check())a.singlebutton&&wfu_clear_files(e);else{var s=r;s+=s;var o=wfu_get_filelist(e);s=0;for(var l=0;l<o.length;l++)if(s++,wfu_BrowserCaps.supportsFileChunking&&a.chunk&&o[l].size>GlobalData.consts.wfu_chunk_size){var n=Math.floor(o[l].size/GlobalData.consts.wfu_chunk_size);o[l].size-n*GlobalData.consts.wfu_chunk_size>0&&n++,s+=n}else s++;if(wfu_check_required_userdata(e,!0)){if(wfu_Code_Objects[e].apply_filters("pre_start_check",!0)){var i=wfu_randomString(10);if(wfu_lock_upload(e),wfu_Code_Objects[e].do_action("pre_start"),wfu_Code_Objects[e].apply_filters("pre_start_ask_server",!1,a.has_filters?"true":"false")){var _=GlobalData.consts.ajax_url;params=new Array(5),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_ask_server",params[1]=new Array(2),params[1][0]="session_token",params[1][1]=a.session,params[2]=new Array(2),params[2][0]="sid",params[2][1]=e,params[3]=new Array(2),params[3][0]="unique_id",params[3][1]=i,params[4]=new Array(2),params[4][0]="wfu_uploader_nonce",params[4][1]=wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e);var u=wfu_Code_Objects[e].apply_filters("askserver_pass_params",{});for(var d in u)u.hasOwnProperty(d)&&params.push([d,u[d]]);var c="";for(l=0;l<params.length;l++)c+=(l>0?"&":"")+params[l][0]+"="+encodeURI(params[l][1]);t.open("POST",_,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status){var a=t.responseText,r="",s=a.indexOf("wfu_askserver_success:"),o=a.indexOf("wfu_askserver_error:");s>-1?(r=a.substr(s+22),wfu_Code_Objects[e].do_action("askserver_success",r,"ajax"),wfu_HTML5UploadFile_cont(e,i)):o>-1&&(r=a.substr(o+20),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_error",r))}else alert(GlobalData.consts.remoteserver_noresult),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_noresult")},t.send(c)}else wfu_HTML5UploadFile_cont(e,i)}}else a.singlebutton&&wfu_clear_files(e)}}}else wfu_redirect_to_classic(e,1,2);else wfu_redirect_to_classic(e,1,1)}function wfu_HTML5UploadFile_cont(e,a){function t(r,u,d,p){c=!0;var w=wfu_GetHttpRequestObject(),m=wfu_GetHttpRequestObject();if(null!=w&&null!=m){var b=null,g=null;try{b=new FormData,g=new FormData}catch(e){}if(null!=b&&null!=g){b.append("action","wfu_ajax_action"),b.append("wfu_uploader_nonce",wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)),d||b.append("uploadedfile_"+e+_,u),n[r].isBlob&&b.append("uploadedfile_"+e+"_isblob",1),b.append("uploadedfile_"+e+"_index",r),b.append("uploadedfile_"+e+"_name",wfu_plugin_encode_string(n[r].name)),b.append("uploadedfile_"+e+"_size",n[r].size),b.append("uniqueuploadid_"+e,a),b.append("params_index",o.params_index),b.append("subdir_sel_index",l),b.append("nofileupload_"+e,i?"1":"0"),d?b.append("only_check","1"):b.append("only_check","0"),GlobalData[e].uploadflag[r]=1,0==GlobalData[e].metrics[r].start_time&&(GlobalData[e].metrics[r].start_time=(new Date).getTime());var h="0,0,0,0,";arguments.length>4&&(h=arguments[4]);var v=h.split(",");b.append("chunk_data",h),b.append("session_token",o.session);var y=wfu_Code_Objects[e].apply_filters("upload_pass_params",{},"ajax");for(var G in y)y.hasOwnProperty(G)&&b.append(G,y[G]);for(var x=wfu_get_userdata_count(e),D=0;D<x;D++)b.append("hiddeninput_"+e+"_userdata_"+D,wfu_get_stored_formdata(e,"hiddeninput_"+e+"_userdata_"+D));if(wfu_initialize_fileupload_xhr(w,e,a,r,n[r].name),w.loading=!0,w.chunk_id=0==v[2]?0:parseInt(v[3])+1,d||(w.size=u.size,w.totalsize=n[r].size,v[2]>0&&(GlobalData[e].chunkedfile[r].xhrid[w.chunk_id-1]=w.xhrid,GlobalData[e].chunkedfile[r].uploadflag[w.chunk_id-1]=1,GlobalData[e].chunkedfile[r].lasttime[w.chunk_id-1]=w.start_time)),p){g.append("action","wfu_ajax_action"),g.append("wfu_uploader_nonce",wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)),g.append("params_index",o.params_index),g.append("session_token",o.session),g.append("force_connection_close","1"),m.open("POST",GlobalData.consts.ajax_url,!1);try{m.send(g)}catch(e){}c=m.responseText.indexOf("success")>-1}if(c)d?(w.addEventListener("load",(function(a){a={target:{responseText:a.target.responseText,shortcode_id:e,return_status:!0}};var l=wfu_uploadComplete.call(w,a);if(w.file_id=0,(c="success"==l||"warning"==l)&&!i)if(wfu_BrowserCaps.supportsFileChunking&&o.chunk&&u.size>GlobalData.consts.wfu_chunk_size){Math.floor(u.size/GlobalData.consts.wfu_chunk_size);var n=(u.size,GlobalData.consts.wfu_chunk_size,new Date);f[r]={},f[r].reps=Math.floor(u.size/GlobalData.consts.wfu_chunk_size),f[r].rem=u.size-f[r].reps*GlobalData.consts.wfu_chunk_size,f[r].chunk_count=0==f[r].rem?f[r].reps:f[r].reps+1,GlobalData[e].chunkedfile||(GlobalData[e].chunkedfile=[]),GlobalData[e].chunkedfile[r]={},GlobalData[e].chunkedfile[r].starttime=n.getTime(),GlobalData[e].chunkedfile[r].uploadflag=Array.apply(null,new Array(f[r].chunk_count)).map(Number.prototype.valueOf,0),GlobalData[e].chunkedfile[r].xhrid=Array.apply(null,new Array(f[r].chunk_count)).map(Number.prototype.valueOf,-1),GlobalData[e].chunkedfile[r].retries=Array.apply(null,new Array(f[r].chunk_count)).map(Number.prototype.valueOf,0),GlobalData[e].chunkedfile[r].lasttime=Array.apply(null,new Array(f[r].chunk_count)).map(Number.prototype.valueOf,0),s(r)}else t(r,u,!1,!1)}),!1),w.addEventListener("error",(function(e){}),!1),w.open("POST",GlobalData.consts.ajax_url,!0),w.send(b)):(w.upload.xhr=w,w.upload.dummy=1,w.upload.addEventListener("loadstart",wfu_loadStart,!1),w.upload.addEventListener("progress",new Function("evt","wfu_uploadProgress(evt, "+e+", "+w.xhrid+", "+(o.debugmode?"true":"false")+");"),!1),w.addEventListener("load",wfu_uploadComplete,!1),w.addEventListener("error",new Function("evt","wfu_uploadFailed(evt, "+(o.debugmode?"true":"false")+");"),!1),w.addEventListener("abort",wfu_uploadCanceled,!1),w.open("POST",GlobalData.consts.ajax_url,!0),w.send(b));else{var k={target:{responseText:"",shortcode_id:e}};wfu_uploadComplete.call(w,k)}return c}}}function r(){if(-1==parseInt(GlobalData.consts.wfu_concurrent_connections))return!1;for(var a=0,t=0;t<GlobalData[e].xhrs.length;t++)GlobalData[e].xhrs[t].file_id>0&&GlobalData[e].xhrs[t].loading&&!GlobalData[e].xhrs[t].aborted&&a++;return a>=parseInt(GlobalData.consts.wfu_concurrent_connections)}function s(a){if(parseInt(GlobalData.consts.wfu_unfinishedchunk_inactivity_period)>-1)for(var l=Math.max(parseInt(GlobalData.consts.wfu_unfinishedchunk_inactivity_period),parseInt(GlobalData.consts.max_time_limit)),i=new Date,_=0;_<GlobalData[e].chunkedfile[a].uploadflag.length;_++)if(1==GlobalData[e].chunkedfile[a].uploadflag[_]&&i.getTime()>GlobalData[e].chunkedfile[a].lasttime[_]+1e3*l){o.debugmode&&console.log("reseting chunk "+_+" of file "+a);var u=GlobalData[e].chunkedfile[a].xhrid[_];wfu_chunk_reset(GlobalData[e].xhrs[u])}var d=-1,p=!0;for(_=0;_<GlobalData[e].chunkedfile[a].uploadflag.length;_++)if(GlobalData[e].chunkedfile[a].uploadflag[_]<2&&(p=!1,0==GlobalData[e].chunkedfile[a].uploadflag[_])){d=_;break}if(p){var w=(new Date).getTime(),m=0;for(_=0;_<GlobalData[e].xhrs.length;_++)GlobalData[e].xhrs[_].file_id==a+1&&(w=Math.min(w,GlobalData[e].xhrs[_].start_time),m=Math.max(m,GlobalData[e].xhrs[_].end_time));var b=(m-w)/1e3;o.debugmode&&console.log("Upload time: "+b)}else if(r())setTimeout((function(){s(a)}),1e3);else{var g=function(a){for(var t=!1,r=0,s=0;s<GlobalData[e].xhrs.length;s++)if(GlobalData[e].xhrs[s].file_id==a+1){if(GlobalData[e].xhrs[s].aborted){t=!0;break}GlobalData[e].xhrs[s].loading&&r++}return t?-1:r}(a);o.debugmode&&console.log("running chunks: "+g),-1!=g&&(d>=0&&(-1==GlobalData.consts.wfu_concurrent_chunks||g<GlobalData.consts.wfu_concurrent_chunks)?(f[a].j=d,function(e){if(n[e]){var a=f[e].j*parseInt(GlobalData.consts.wfu_chunk_size),r=parseInt(GlobalData.consts.wfu_chunk_size);if(f[e].rem>0&&f[e].j==f[e].reps&&(r=f[e].rem),"function"==typeof n[e].slice)var o=n[e].slice(a,a+r);else"function"==typeof n[e].webkitSlice&&(o=n[e].webkitSlice(a,a+r));var l=e+","+n[e].size+","+f[e].chunk_count+","+f[e].j+","+wfu_plugin_encode_string(n[e].name);wfu_BrowserCaps.isSafari?(c=t(e,o,!1,!0,l),s(e)):(t(e,o,!1,!1,l),s(e))}}(a)):setTimeout((function(){s(a)}),1e3))}}var o=GlobalData.WFU[e],l=-1;o.subfolders_exist&&(l=o.subfolders.index());var n=wfu_get_filelist(e),i=!1;0==n.length&&o.allownofile&&(i=!0,n=[{name:"dummy.txt",size:0}]);var _="";GlobalData.UploadInProgressString+="["+a+"]",GlobalData[e]={},GlobalData[e].unique_id=a,GlobalData[e].last=!1,GlobalData[e].files_count=n.length,GlobalData[e].files_processed=0,GlobalData[e].upload_state=0,GlobalData[e].nofileupload=i,GlobalData[e].store_nothing=!!o.consent_exist&&"no"==wfu_get_stored_formdata(e,"consentresult_"+e)&&o.not_store_files,GlobalData[e].message=[],GlobalData[e].update_wpfilebase="",GlobalData[e].redirect_link="",GlobalData[e].notify_by_email=0,GlobalData[e].admin_messages={},GlobalData[e].admin_messages.wpfilebase="",GlobalData[e].admin_messages.notify="",GlobalData[e].admin_messages.redirect="",GlobalData[e].admin_messages.debug=[],GlobalData[e].admin_messages.other=[],GlobalData[e].errors={},GlobalData[e].errors.wpfilebase="",GlobalData[e].errors.notify="",GlobalData[e].errors.redirect="",GlobalData[e].xhrs=Array(),GlobalData[e].metricstotal={size:n[0].size,loaded:0,progress_pos:0,start_time:(new Date).getTime(),last_time:0,end_time:0},GlobalData[e].metrics=[{size:n[0].size,loaded:0,progress_pos:0,start_time:0,last_time:0,end_time:0,aborted:!1}],GlobalData[e].uploadflag=Array.apply(null,new Array(n.length)).map(Number.prototype.valueOf,0);for(var u=1;u<n.length;u++)GlobalData[e].metricstotal.size+=n[u].size,GlobalData[e].metrics[u]={size:n[u].size,loaded:0,progress_pos:0,start_time:0,end_time:0};o.progressbar_exist&&!i&&o.progressbar.show("progressive"),o.filelist_exist&&(o.filelist.afterUploadStart(i?"shuffle":"progressive",!1),o.filelist.setVisibility(!i)),GlobalData.WFU[e].multiple&&(_="[]"),wfu_attach_cancel_event(e,a);var d=wfu_Initialize_Params();d.general.shortcode_id=e,d.general.unique_id=a,wfu_ProcessUploadComplete(e,0,d,a,"",[!1,null,!1]);var c=!0,f=[];setTimeout((function a(){if(r())setTimeout(a,1e3);else{for(var s=0,o=0;o<GlobalData[e].uploadflag.length;o++)1==GlobalData[e].uploadflag[o]&&s++;if(GlobalData.consts.wfu_concurrent_files<=0||s<GlobalData.consts.wfu_concurrent_files){var l=-1;for(o=0;o<GlobalData[e].uploadflag.length;o++)if(0==GlobalData[e].uploadflag[o]){l=o;break}l>=0&&(t(l,n[l],!0,!1),setTimeout(a,100))}else setTimeout(a,1e3)}}),100)}function wfu_initialize_fileupload_xhr(e,a,t,r,s){var o=GlobalData.WFU[a],l=r>=0?GlobalData[a].xhrs.push(e)-1:-1,n=new Date;e.xhrid=l,e.shortcode_id=a,e.requesttype=r>=0?"fileupload":"email",e.file_id=r+1,e.chunk_id=0,e.size=0,e.totalsize=0,e.loading=!1,e.deltasize=0,e.deltaloaded=0,e.sizeloaded=0,e.aborted=!1,e.unique_id=t,e.start_time=n.getTime(),e.end_time=e.start_time,e.finish_time=e.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),e.success_message_header=o.success_header.replace(/%username%/g,"no data"),e.success_message_header=e.success_message_header.replace(/%useremail%/g,"no data"),e.success_message_header=e.success_message_header.replace(/%filename%/g,s),e.success_message_header=e.success_message_header.replace(/%filepath%/g,s),e.error_message_header=o.error_header.replace(/%username%/g,"no data"),e.error_message_header=e.error_message_header.replace(/%useremail%/g,"no data"),e.error_message_header=e.error_message_header.replace(/%filename%/g,s),e.error_message_header=e.error_message_header.replace(/%filepath%/g,s),e.error_message_failed=GlobalData.consts.message_failed,e.error_message_cancelled=GlobalData.consts.message_cancelled,e.error_adminmessage_unknown=GlobalData.consts.adminmessage_unknown.replace(/%username%/g,"no data"),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%useremail%/g,"no data"),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%filename%/g,s),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%filepath%/g,s)}function wfu_get_userdata_count(e){var a=GlobalData.WFU[e],t=0;return a.userdata_exist&&(t=a.userdata.props.length),t}function wfu_lock_upload(e){var a=GlobalData.WFU[e];a.textbox_exist&&a.textbox.update("lock"),a.uploadform_exist&&a.uploadform.lock(),a.subfolders_exist&&a.subfolders.toggle(!1),a.submit_exist&&a.submit.toggle(!1),a.filelist_exist&&a.filelist.disableEditing(a.is_formupload),a.dragdrop_exist&&a.dragdrop.disableDragDrop();for(var t=wfu_get_userdata_count(e),r=0;r<t;r++)a.userdata.codes[r].lock();wfu_Code_Objects[e].do_action("lock_upload")}function wfu_unlock_upload(e){var a=GlobalData.WFU[e];a.textbox_exist&&a.textbox.update("unlock"),a.uploadform_exist&&a.uploadform.unlock(),a.subfolders_exist&&a.subfolders.toggle(!0),a.submit_exist&&a.submit.toggle(!0),a.filelist_exist&&(a.filelist.enableEditing(a.is_formupload),wfu_update_filelist(e)),a.dragdrop_exist&&a.dragdrop.reEnableDragDrop();for(var t=wfu_get_userdata_count(e),r=0;r<t;r++)a.userdata.codes[r].unlock();wfu_Code_Objects[e].do_action("unlock_upload")}function wfu_clear_files(e){var a=GlobalData.WFU[e];a.uploadform_exist&&a.uploadform.reset(),void 0!==a.filearray&&(a.filearray.length=0,a.filearrayprops.length=0),a.textbox_exist&&a.textbox.update("clear"),wfu_filelist_clear(e),a.webcam_exist&&wfu_reinitialize_webcam(e)}function wfu_check_reset(e){var a=GlobalData.WFU[e],t=GlobalData[e];return"always"==a.resetmode||"never"!=a.resetmode&&("onsuccess"==a.resetmode?[4,5,6,14].indexOf(t.upload_state)>-1:"onfullsuccess"!=a.resetmode||[4,5,14].indexOf(t.upload_state)>-1)}function wfu_clear(e){var a=GlobalData.WFU[e],t=wfu_check_reset(e);if(wfu_clear_files(e),t){a.subfolders_exist&&a.subfolders.reset();for(var r=wfu_get_userdata_count(e),s=0;s<r;s++)a.userdata.codes[s].reset();a.uploadform_exist&&a.uploadform.resetDummy()}wfu_Code_Objects[e].do_action("clear_upload")}function wfu_invoke_shortcode_editor(e){var a=e.shortcode_id,t=0,r=GlobalData.WFU.n;"wordpress_file_upload_browser"==e.shortcode_tag&&(r=GlobalData.WFUB.n);for(var s=0;s<r.length;s++)r[s]==a&&t++;if(0!=t)if(t>1)alert(GlobalData.consts.same_pluginid);else{var o=wfu_GetHttpRequestObject();if(null!=o){e.visualeditorbutton.update("on_invoke");var l=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_edit_shortcode",params[1]=new Array(2),params[1][0]="upload_id",params[1][1]=a,params[2]=new Array(2),params[2][0]="post_id",params[2][1]=e.post_id,params[3]=new Array(2),params[3][0]="post_hash",params[3][1]=e.post_hash,params[4]=new Array(2),params[4][0]="shortcode_tag",params[4][1]=e.shortcode_tag,params[5]=new Array(2),params[5][0]="widget_id",params[5][1]=e.widgetid?e.widgetid:"";var n="";for(s=0;s<params.length;s++)n+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);o.open("POST",l,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){e.visualeditorbutton.update("on_open");var a=o.responseText.indexOf("wfu_edit_shortcode:");-1==a&&(a=o.responseText.length),o.responseText.substr(0,a);var t=o.responseText.substr(a+19,o.responseText.length-a-19);a=t.indexOf(":");var r=t.substr(0,a);if(txt_value=t.substr(a+1,t.length-a-1),"success"==r){var s=window.open(wfu_plugin_decode_string(txt_value),"_blank");s?s.plugin_window=window:alert(GlobalData.consts.enable_popups)}else"check_page_obsolete"==r&&alert(txt_value)}},o.send(n)}}}function wfu_browser_load_action(e){var a=GlobalData.WFUB[e];a.visualeditorbutton_exist&&(a.visualeditorbutton.init(),a.visualeditorbutton.attachInvokeHandler((function(){wfu_invoke_shortcode_editor(a)}))),wfu_browser_initialize_bulkactions(e)}function wfu_apply_bulkaction_select(e){void 0!==window["wfu_apply_"+e+"_bulkselect"]&&window["wfu_apply_"+e+"_bulkselect"]()}function wfu_browser_initialize_bulkactions(e){document.getElementById("wfu_browser_"+e+"_bulkactions")&&(window["wfu_apply_browser_"+e+"_bulkaction"]=new Function("wfu_apply_browser_bulkaction("+e+");"),window["wfu_apply_browser_"+e+"_bulkselect"]=new Function("wfu_apply_browser_bulkselect("+e+");"))}function wfu_apply_browser_bulkselect(e){var a=document.getElementById("wfu_browser_"+e+"_bulkactions");if(!(a.selectedIndex<1)){var t=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel:checked");if(0!=t.length)for(var r=a.options[a.selectedIndex].value,s=0;s<t.length;s++){var o="remote_"==t[s].className.replace(/.*?wfu_selcode_/,"").substr(0,7);("delete"==r&&o||"remove_remote"==r&&!o)&&(t[s].checked=!1,wfu_browser_selector_changed(e,t[s]))}}}function wfu_apply_browser_bulkaction(e){var a=document.getElementById("wfu_browser_"+e+"_bulkactions");if(!(a.selectedIndex<1)){wfu_apply_browser_bulkselect(e);var t=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel:checked");if(0!=t.length){codes=[];for(var r=0;r<t.length;r++){var s=t[r].className.replace(/.*?wfu_selcode_/,"").replace("remote_","");""!=s&&codes.push(s)}var o=a.options[a.selectedIndex].value;"delete"!=o&&"remove_remote"!=o||wfu_delete_file_frontend(e,codes,!1,"remove_remote"==o)}}}function wfu_add_cookies(e){for(var a=0;a<e.length;a++){var t=new Date;t.setTime(t.getTime()+1e3*e[a].expires),document.cookie=e[a].name+"="+e[a].value+"; expires="+t.toUTCString()+"; path=/"}}GlobalData={},Code_Initializators=[],GlobalData.WFU={n:[]},GlobalData.WFUB={n:[]},GlobalData.filestatematch={},GlobalData.filestatematch.success=[0,1,2,2],GlobalData.filestatematch.warning=[1,1,2,2],GlobalData.filestatematch.error1=[3,3,2,3],GlobalData.filestatematch.error2=[2,2,2,3],GlobalData.UploadInProgressString="",GlobalData.FreeChangeHandler=!1,wfu_Check_Browser_Capabilities(),"undefined"==typeof wfu_js_decode_obj&&(wfu_js_decode_obj=function(e){var a=null;if("window"==e)a=window;else{var t=String.fromCharCode(92),r=e.match(new RegExp("GlobalData("+t+".(WFU|WFUB)"+t+"[(.*?)"+t+"]("+t+".(.*))?)?$"));r&&(a=GlobalData,r[3]&&(a=a[r[2]][r[3]]),r[5]&&(a=a[r[5]]))}return a}),wfu_filelist_toggle=function(e){var a=GlobalData.WFU[e];if(a.filelist_exist){var t=a.filelist.visible();a.filelist.setVisibility(!t)}},wfu_filelist_removeall=function(e){var a=GlobalData.WFU[e];a.filelist_exist&&1==confirm(a.filelist.clear_confirm_message)&&(a.uploadform_exist&&a.uploadform.reset(),wfu_selectbutton_changed(e,0),wfu_update_uploadbutton_status(e))},wfu_filelist_removefile=function(e,a){void 0!==GlobalData.WFU[e].filearray&&(GlobalData.WFU[e].filearray.splice(a,1),GlobalData.WFU[e].filearrayprops.splice(a,1),wfu_update_filelist(e),wfu_update_filename_text(e),wfu_update_uploadbutton_status(e))},wfu_filelist_clear=function(e){var a=GlobalData.WFU[e];void 0!==a.filearray&&(a.filearray.length=0,a.filearrayprops.length=0),wfu_update_filelist(e),a.filelist_exist&&a.filelist.resetTotalProgress(),wfu_update_filename_text(e),wfu_update_uploadbutton_status(e)},wfu_update_filelist=function(e){var a=GlobalData.WFU[e];if(a.filelist_exist){var t=wfu_get_filelist(e);a.filelist.updateList(t,a.is_formupload),a.filelist.setVisibility(t.length>0)}},Code_Initializators[Code_Initializators.length]=function(sid){var CBUV_Code_Objects={pre_start_check:function(e){if(!e)return e;var a=this.sid,t=!0;return GlobalData.WFU[a].consent_exist&&("prompt"!=GlobalData.WFU[a].consent.consent_format&&""==wfu_get_stored_formdata(a,"consentresult_"+a)?(alert(GlobalData.consts.wfu_consent_notcompleted),t=!1):"prompt"==GlobalData.WFU[a].consent.consent_format&&(wfu_set_stored_formdata(a,"consentresult_"+a,confirm(GlobalData.WFU[a].consent.consent_question)?"yes":"no"),t=!0),GlobalData.WFU[a].consent.no_rejects_upload&&"no"==wfu_get_stored_formdata(a,"consentresult_"+a)&&(alert(GlobalData.WFU[a].consent_rejection_message),t=!1)),t},pre_start_ask_server:function(e,a){if(e)return e;var t=this.sid,r=GlobalData.WFU[t].consent_maybe_ask_server&&!GlobalData.WFU[t].consent_exist;return"true"==a||r},askserver_pass_params:function(e){for(var a=this.sid,t=wfu_get_filelist(a),r="",s="",o=0;o<t.length;o++)o>0&&(r+=";",s+=";"),r+=wfu_plugin_encode_string(t[o].name),s+=t[o].size;var l=[],n=wfu_get_userdata_count(a);for(o=0;o<n;o++)l.push("_"+wfu_plugin_encode_string(wfu_get_stored_formdata(a,"hiddeninput_"+a+"_userdata_"+o)));return e.filenames=r,e.filesizes=s,e.userdata=l.join(";"),GlobalData.WFU[a].consent_maybe_ask_server&&!GlobalData.WFU[a].consent_exist&&(e.consent_check="1",e.consent_rejection_message=GlobalData.WFU[a].consent_rejection_message),e},askserver_success:function(response,mode){var sid=this.sid,upload_status="success",txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";""!=txt_header&&eval(wfu_plugin_decode_string(txt_header))},askserver_error:function(response,mode){var sid=this.sid,upload_status="error",txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";if(""!=txt_header&&eval(wfu_plugin_decode_string(txt_header)),txt_match=response.match(/CBUV\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"",""!=txt_header){var Params=wfu_Initialize_Params();GlobalData[sid]={},Params.general.shortcode_id=sid,Params.general.message=txt_header,Params.general.state=12,wfu_ProcessUploadComplete(sid,0,Params,"no-ajax","",[!1,null,!1]),wfu_clear(sid)}},lock_upload:function(){var e=this.sid;GlobalData.WFU[e].consent_exist&&GlobalData.WFU[e].consent.update("lock")},unlock_upload:function(){var e=this.sid;GlobalData.WFU[e].consent_exist&&GlobalData.WFU[e].consent.update("unlock")},clear_upload:function(){var e=this.sid,a=GlobalData.WFU[e];a.consent_exist&&(a.consent.remember_consent?(a.consent.update("clear"),a.consent_exist=!1):a.consent.update("init"))},upload_pass_params:function(e,a){var t=this.sid;return GlobalData.WFU[t].consent_exist&&(e.consent_result=wfu_get_stored_formdata(t,"consentresult_"+t)),e},after_upload:function(response){var sid=this.sid,txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";""!=txt_header&&eval(wfu_plugin_decode_string(txt_header))}};return CBUV_Code_Objects},Code_Initializators[Code_Initializators.length]=function(e){var a={priority:1,uploadbutton_status:function(e){if(!e)return e;var a=this.sid,t=!0;return GlobalData.WFU[a].captcha_exist&&(t=""!=wfu_get_stored_formdata(a,"captchainput_"+a)),t},pre_start_check:function(e){if(!e)return e;var a=this.sid,t=!0;return GlobalData.WFU[a].captcha_exist&&""==wfu_get_stored_formdata(a,"captchainput_"+a)&&(wfu_set_captcha_state(a,"empty",""),t=!1),t},lock_upload:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&wfu_set_captcha_state(e,"locked","")},pre_start:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&wfu_set_captcha_state(e,"checking","")},pre_start_ask_server:function(e,a){if(e)return e;var t=this.sid;return!!GlobalData.WFU[t].captcha_exist},askserver_pass_params:function(e){var a=this.sid;if(GlobalData.WFU[a].captcha_exist){var t="";"RecaptchaV1"==GlobalData.WFU[a].captcha.type&&(t="[V1]"),e.captcha_challenge=t+wfu_get_stored_formdata(a,"captchachallenge_"+a),e.captcha_input=wfu_get_stored_formdata(a,"captchainput_"+a)}return e},upload_pass_params:function(e,a){var t=this.sid;return GlobalData.WFU[t].captcha_exist&&"ajax"==a&&(e.captcha_verify=wfu_get_stored_formdata(t,"captchainput_"+t)),e},unlock_upload:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&wfu_set_captcha_state(e,"unlocked","")},askserver_error:function(e,a){var t=this.sid;GlobalData.WFU[t].captcha_exist&&wfu_process_captcha_error(t,e)},askserver_noresult:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&wfu_set_captcha_state(e,"idle","true")},not_supported:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&(alert(GlobalData.consts.captchamessage_notsupported),wfu_set_captcha_state(e,"error",GlobalData.consts.captchamessage_notsupported))},clear_upload:function(){var e=this.sid;GlobalData.WFU[e].captcha_exist&&wfu_set_captcha_state(e,"idle","true")}};return a},wfu_captcha_init=function(e,a,t,r,s){if("RecaptchaV1"==a){if("undefined"!=typeof wfu_Captcha_Ref_LoadedV1&&wfu_Captcha_Ref_LoadedV1)window["recaptcha_nomultiple_"+e]=function(){GlobalData.WFU[e].captcha.updateStatus("nomultiple")},wfu_addEventHandler(window,"load",window["recaptcha_nomultiple_"+e]);else{wfu_Captcha_Ref_LoadedV1=!1,window["recaptcha_callback_"+e]=function(){var a=document.getElementById("recaptcha_response_field");a&&wfu_attach_element_handlers(a,window["recaptcha_hook_"+e])},window["RecaptchaOptions_"+e]=r,window["RecaptchaOptions_"+e].callback=window["recaptcha_callback_"+e],window["recaptcha_hook_"+e]=function(){wfu_set_stored_formdata(e,"captchachallenge_"+e,Recaptcha.get_challenge()),wfu_captcha_changed(e,document.getElementById("recaptcha_response_field").value)},window["recaptcha_register_"+e]=function(){Recaptcha.create(t,GlobalData.WFU[e].captcha.core().id,window["RecaptchaOptions_"+e])},wfu_addEventHandler(window,"load",window["recaptcha_register_"+e]);var o=function(){var a=document.createElement("SCRIPT");a.setAttribute("type","text/javascript"),a.setAttribute("src","https://www.google.com/recaptcha/api/js/recaptcha_ajax.js"),document.getElementById(GlobalData.WFU[e].container_id).appendChild(a)}}s||wfu_Captcha_Ref_LoadedV1||(wfu_Captcha_Ref_LoadedV1=!0,o())}else"RecaptchaV2"==a&&("undefined"==typeof wfu_Captcha_Instances&&(wfu_Captcha_Instances=[]),wfu_Captcha_Instances.push(e),"undefined"==typeof wfu_Captcha_Ref_Loaded&&(wfu_Captcha_Ref_Loaded=!1),window["verifyCallback_"+e]=function(a){wfu_captcha_ok(e,a)},window["expiredCallback_"+e]=function(a){wfu_captcha_expired(e)},window["captcha_instance_"+e]=null,window.wfu_onloadCallback||(wfu_onloadCallback=function(){for(var e=0;e<wfu_Captcha_Instances.length;e++){var a=wfu_Captcha_Instances[e],s=r;s.sitekey=t,s.callback=window["verifyCallback_"+a],s["expired-callback"]=window["expiredCallback_"+a],window["captcha_instance_"+a]=grecaptcha.render(GlobalData.WFU[a].captcha.core(),s)}wfu_Captcha_Instances=[]}),s?wfu_addEventHandler(window,"load",wfu_onloadCallback):wfu_Captcha_Ref_Loaded?"undefined"!=typeof grecaptcha&&wfu_onloadCallback():(wfu_Captcha_Ref_Loaded=!0,l=document.createElement("SCRIPT"),n=GlobalData.WFU[e].captcha.host,l.setAttribute("type","text/javascript"),l.setAttribute("src","https://"+n+"/recaptcha/api.js?onload=wfu_onloadCallback&render=explicit"),l.setAttribute("async",!0),l.setAttribute("defer",!0),document.getElementById(GlobalData.WFU[e].container_id).appendChild(l)));var l,n},wfu_process_message=function(e,a){if(e.origin===a&&e.data.command&&e.data.data)if("wfu_notify_captcha_ok"==e.data.command){if(!e.data.data.response||!e.data.data.sid)return;wfu_captcha_ok(e.data.data.sid,e.data.data.response)}else if("wfu_notify_captcha_expired"==e.data.command){if(!e.data.data.sid)return;wfu_captcha_expired(e.data.data.sid)}else if("wfu_resize_captcha_frame"==e.data.command){if(!e.data.data.sid||!e.data.data.width||!e.data.data.height)return;var t=e.data.data.sid;GlobalData.WFU[t].captcha.resize(e.data.data.width,e.data.data.height)}else if("wfu_input_changed"==e.data.command){if(!e.data.data.sid)return;wfu_set_stored_formdata(e.data.data.sid,"captchachallenge_"+e.data.data.sid,e.data.data.challenge),wfu_captcha_changed(e.data.data.sid,e.data.data.input)}},wfu_set_captcha_state=function(e,a,t){GlobalData.WFU[e].captcha_exist&&("value"!=a?("idle"==a?(wfu_set_stored_formdata(e,"captchainput_"+e,""),"true"==t&&wfu_send_captcha_reset_command(e)):"error"==a&&wfu_send_captcha_reset_command(e),GlobalData.WFU[e].captcha.updateStatus(a,t)):wfu_set_stored_formdata(e,"captchainput_"+e,t))},wfu_send_captcha_reset_command=function(e){window["wfu_send_captcha_reset_command_invoker_"+e]&&(window["wfu_send_captcha_reset_command_invoker_"+e](),wfu_set_captcha_state(e,"value",""),wfu_update_uploadbutton_status(e))},wfu_send_captcha_reset_command_internal=function(e){if(GlobalData.WFU[e].captcha_exist){var a=GlobalData.WFU[e].captcha.type.substr(9);if("V1"==a.substr(0,2)){if(!Recaptcha)return;Recaptcha.reload()}if("V2"==a.substr(0,2)){if(!grecaptcha||void 0===window["captcha_instance_"+e])return;grecaptcha.reset(window["captcha_instance_"+e])}}},wfu_send_captcha_reset_command_external=function(e,a){var t=GlobalData.WFU[e].captcha.core();t&&(t.contentWindow||t).postMessage({command:"wfuca_reset_captcha",data:{}},a)},wfu_captcha_ok=function(e,a){wfu_set_captcha_state(e,"value",""),""==a||a.toLowerCase().indexOf("error")>-1||(wfu_set_captcha_state(e,"value",a),wfu_update_uploadbutton_status(e))},wfu_captcha_changed=function(e,a){wfu_set_captcha_state(e,"value",a),wfu_update_uploadbutton_status(e)},wfu_captcha_expired=function(e){GlobalData.WFU[e].captcha.isLocked()||(wfu_set_captcha_state(e,"value",""),wfu_update_uploadbutton_status(e))},wfu_process_captcha_error=function(e,a){var t=a.match(/captcha\[(.*?)\]/),r=t&&void 0!==t[1]?t[1]:"";if(""==r||"noprocess"==r)wfu_set_captcha_state(e,"idle","true");else{var s="";if("nochallenge"==r||"noinput"==r||"wrongcaptcha"==r)s=GlobalData.consts["captchamessage_"+r];else if("("==r.substr(0,1)&&")"==r.substr(r.length-1,1))for(var o=(r=r.substr(1,r.length-2)).split("|"),l=0;l<o.length;l++)GlobalData.consts["captchamessage_"+o[l].trim()]&&(""!=s&&(s+=" and "),s+=GlobalData.consts["captchamessage_"+o[l].trim()]);""==s&&(s=GlobalData.consts.captchamessage_unknownerror),wfu_set_captcha_state(e,"error",s)}},Code_Initializators[Code_Initializators.length]=function(e){var a={pre_load:function(e){var a=this.sid,t=GlobalData.WFU[a];t.RR||(t.RR=e=>{let a;return t.R?t.R[e]?a=t.R[e]:console.log("Template "+e+" not loaded yet"):console.log("React not loaded yet when loading "+e),a})}};return a},wfu_create_react_dom=(e,a)=>{var t=("shadow-dom"==a.forceSpecificity?document.getElementById("wordpress_file_upload_block_"+a.ID).dom:document).getElementById(e);a.root=(a.root??[]).concat([t])},wfu_render_react_component=e=>{window.WFUReact?window.WFUReact[e.slot](e):(GlobalData.reactLoadSlots||(GlobalData.reactLoadSlots=[]),GlobalData.reactLoadSlots.push(e))},wfu_chunk_reset=function(e){var a=e.shortcode_id,t=e.file_id;e.file_id=0;for(var r=0;r<GlobalData[a].xhrs.length;r++)GlobalData[a].xhrs[r].file_id==t&&(GlobalData[a].xhrs[r].totalsize-=e.deltasize);e.size=0,e.totalsize=0,e.deltasize=0,e.sizeloaded=0,e.abort(),GlobalData[a].chunkedfile[t-1].uploadflag[e.chunk_id-1]=0,GlobalData[a].chunkedfile[t-1].xhrid[e.chunk_id-1]=-1},wfu_Attach_DragDrop_Events=function(e){if(wfu_BrowserCaps.supportsDRAGDROP&&GlobalData.WFU[e].dragdrop_exist){var a={dragenter:null,dragover:null,dragleave:null,drop:function(a){wfu_selectfiles_fromdrag(e,a)},windowdragenter:function(){wfu_selectbutton_clicked(e)},windowdragover:null,windowdragleave:null,windowdrop:null};GlobalData.WFU[e].dragdrop.init(),GlobalData.WFU[e].dragdrop.attachHandlers(a)}},wfu_selectfiles_fromdrag=function(e,a){var t=GlobalData.WFU[e];if(wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5&&wfu_BrowserCaps.supportsDRAGDROP&&0!=a.length){for(var r=[],s=t.multiple?a.length:1,o=0;o<s;o++)r.push({file:a[o],props:{from:"dragdrop"}});wfu_add_files(e,r,t.multiple),wfu_update_filelist(e),wfu_update_filename_text(e),t.singlebutton?t.uploadaction():wfu_update_uploadbutton_status(e)}},wfu_browser_mouseover=function(e,a){var t=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_actions");if(0!=t.length){for(var r in t)t.item(r).style.visibility="hidden";var s=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+a+" .wfu_actions");s&&(s.style.visibility="visible")}},wfu_browser_mouseout=function(e){var a=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_actions");if(0!=a.length)for(var t in a)a.item(t).style.visibility="hidden"},wfu_get_browser_fileprops=function(e){for(var a=[],t=document.querySelectorAll(".wfu_browser-"+e+"_columns"),r=0;r<t.length;r++){var s=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_data_"+t[r].value);if(s.length>a.length)for(var o=0;o<s.length;o++)a[o]={};for(o=0;o<s.length;o++)a[o][t[r].value]=wfu_plugin_decode_string(s[o].value);var l=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_data_"+t[r].value+"_sort");for(o=0;o<l.length;o++)a[o][t[r].value+"_sort"]=l[o].value}var n=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_data_file_id"),i=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_data_file_code"),_=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_data_file_id0"),u=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+" .wfu_actions");for(r=0;r<n.length;r++)a[r].file_id=n[r].value;for(r=0;r<i.length;r++)a[r].file_code=i[r].value;for(r=0;r<_.length;r++)a[r].file_id0=_[r].value;for(r=0;r<u.length;r++)a[r].actions_html=u[r].innerHTML;for(r=0;r<a.length;r++)a[r].included=!0;return a},wfu_browser_apply_fileprops=function(e,a){if(document.querySelector(".wfu_browser_table.wfu_browser-"+e)){var t=document.querySelectorAll(".wfu_browser-"+e+"_columns"),r=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+":not(.wfu_head_row)"),s=document.getElementById("wfu_browser_pagerows_"+e).value,o=document.getElementById("wfu_browsernav_"+e+"_pages"),l=1;o&&(l=o.selectedIndex+1);for(var n,i,_,u,d,c,f,p,w,m=(l-1)*s,b=l*s,g=0,h=0;h<a.length;h++){n=h+1,r.length<h+1&&wfu_browser_addrow(e),a[h].included&&g++,a[h].included&&(0==s||g>m&&g<=b)?(r[h].style.display="table-row",r[h].className=r[h].className.replace("wfu_hidden","wfu_visible").replace("wfu_excluded","wfu_included")):(r[h].style.display="none",a[h].included?r[h].className=r[h].className.replace("wfu_visible","wfu_hidden").replace("wfu_excluded","wfu_included"):r[h].className=r[h].className.replace("wfu_visible","wfu_hidden").replace("wfu_included","wfu_excluded"));for(var v=0;v<t.length;v++)i=t[v].value,_=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_display_"+i),u=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_data_"+i),d=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_data_"+i+"_sort"),c=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_data_file_id"),f=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_data_file_code"),p=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_data_file_id0"),w=document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+n+" .wfu_actions"),"sel"==i?(_.checked=!1,_.name=a[h].file_id,_.className="wfu_display_sel wfu_selcode_"+a[h].file_code):_.innerHTML="inc"==i?g:a[h][i],u.value=wfu_plugin_encode_string(a[h][i]),d&&(d.value=a[h][i+"_sort"]),c.value=a[h].file_id,f.value=a[h].file_code,p.value=a[h].file_id0,w.innerHTML=a[h].actions_html}for(;r.length>a.length;)r[r.length-1].parentNode.removeChild(r[r.length-1]),r=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+":not(.wfu_head_row)")}},wfu_goto_browsernav_page=function(e,a){var t=GlobalData.WFUB[e],r=document.getElementById("wfu_browsernav_"+e+"_pages"),s=r.selectedIndex+1,o=s;if("next"==a?o=Math.min(s+1,r.options.length):"prev"==a?o=Math.max(s-1,1):"last"==a?o=r.options.length:"first"==a?o=1:"sel"==a&&(s=-1),o!=s)if(r.selectedIndex=o-1,t.reload_on_update)wfu_browser_reload(e,!0);else{var l=wfu_get_browser_fileprops(e);l=wfu_browser_apply_client_search_filters(e,l),wfu_browser_apply_fileprops(e,l),document.getElementById("wfu_browsernav_"+e+"_first_disabled").style.display=1==o?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_prev_disabled").style.display=1==o?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_first").style.display=1==o?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_prev").style.display=1==o?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_last_disabled").style.display=o==r.options.length?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_next_disabled").style.display=o==r.options.length?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_last").style.display=o==r.options.length?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_next").style.display=o==r.options.length?"none":"inline",wfu_browser_update_selector_status(e)}},wfu_browsernav_update=function(e,a,t){var r=GlobalData.WFUB[e],s=(document.querySelector(".wfu_browser_table.wfu_browser-"+e),document.getElementById("wfu_browsernav_"+e+"_pages")),o=document.querySelector("#wfu_browsernav_"+e+"_pages + label"),l=document.getElementById("wfu_browser_pagerows_"+e).value;if(0!=l){var n=0;if(r.reload_on_update&&r.paginated)n=parseInt(document.getElementById("wfu_browser_totalincluded_"+e).value);else if(null!=a)for(var i=0;i<a.length;i++)n+=a[i].included?1:0;else n=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+".wfu_included").length;var _=Math.ceil(n/l);if(_<1&&(_=1),void 0===t&&(t=s.selectedIndex+1),t<1&&(t=1),t>_&&(t=_),s.options.length<_)for(i=s.options.length+1;i<=_;i++){var u=document.createElement("OPTION");u.value=i,u.innerHTML=i,s.options.add(u)}else if(s.options.length>_)for(;s.options.length>_;)s.remove(s.options.length-1);s.selectedIndex!=t-1&&(s.selectedIndex=t-1),o.innerHTML="of "+_,document.getElementById("wfu_browsernav_"+e+"_first_disabled").style.display=1==t?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_prev_disabled").style.display=1==t?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_first").style.display=1==t?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_prev").style.display=1==t?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_last_disabled").style.display=t==s.options.length?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_next_disabled").style.display=t==s.options.length?"inline":"none",document.getElementById("wfu_browsernav_"+e+"_last").style.display=t==s.options.length?"none":"inline",document.getElementById("wfu_browsernav_"+e+"_next").style.display=t==s.options.length?"none":"inline"}},wfu_browser_addrow=function(e){if(document.querySelector(".wfu_browser_table.wfu_browser-"+e)){var a=document.querySelector(".wfu_browser_tr_template.wfu_browser-"+e),t=document.querySelectorAll(".wfu_browser_tr.wfu_browser-"+e+":not(.wfu_head_row)"),r=a.cloneNode(!0);r.className="wfu_browser_tr wfu_included wfu_visible wfu_row-"+(t.length+1)+" wfu_browser-"+e,r.onmouseover=new Function("event","wfu_browser_mouseover("+e+", "+t.length+");"),r.onmouseout=new Function("event","wfu_browser_mouseout("+e+");"),a.parentNode.appendChild(r)}},wfu_sort_fileprops=function(e,a,t,r){for(var s,o,l=0;l<r.length-1;l++)for(var n=l+1;n<r.length;n++)if("s"==a?(s=r[n][e+"_sort"].toLowerCase(),o=r[l][e+"_sort"].toLowerCase()):"n"==a&&(s=parseFloat(r[n][e+"_sort"]),o=parseFloat(r[l][e+"_sort"])),s==o&&(s=parseInt(r[n].file_id0),o=parseInt(r[l].file_id0)),t&&s<o||!t&&s>o){var i=r[l];r[l]=r[n],r[n]=i}return r},wfu_browser_sort=function(e,a,t){var r=GlobalData.WFUB[e],s=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/:.*$/,"")!=a;if(document.getElementById("wfu_browser-"+e+"_sort").value=(s?"":"-")+a+":"+t,r.reload_on_update&&r.paginated)wfu_browser_reload(e,!0);else{var o=wfu_get_browser_fileprops(e);o=wfu_sort_fileprops(a,t,s,o),o=wfu_browser_apply_client_search_filters(e,o),wfu_browser_apply_fileprops(e,o),wfu_browser_update_selector_status(e)}},wfu_browser_delete_file=function(e,a){var t=wfu_get_browser_fileprops(e);t.splice(a-1,1),t=wfu_browser_apply_client_search_filters(e,t),wfu_browsernav_update(e,t),wfu_browser_apply_fileprops(e,t)},wfu_browser_select_all_visible_changed=function(e){for(var a=document.getElementById("wfu_browser_select_all_visible_"+e).checked,t=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel"),r=0;r<t.length;r++)t[r].checked=a,wfu_browser_store_selector(e,t[r])},wfu_browser_store_selector=function(e,a){window["wfu_browser_selected_"+e]||(window["wfu_browser_selected_"+e]=[]);var t=a.name,r=window["wfu_browser_selected_"+e].indexOf(t);a.checked&&-1==r?window["wfu_browser_selected_"+e].push(t):!a.checked&&r>-1&&window["wfu_browser_selected_"+e].splice(r,1)},wfu_browser_update_selector_status=function(e){if(window["wfu_browser_selected_"+e]){for(var a,t=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel"),r=0;r<t.length;r++)a=t[r].name,t[r].checked=window["wfu_browser_selected_"+e].indexOf(a)>-1;t[0]&&wfu_browser_selector_changed(e,t[0])}},wfu_browser_selector_changed=function(e,a){var t=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel").length,r=document.querySelectorAll(".wfu_browser_tr.wfu_visible.wfu_browser-"+e+" .wfu_display_sel:checked").length,s=document.getElementById("wfu_browser_select_all_visible_"+e);s.style.webkitAppearance="",s.style.webkitAppearance="checkbox",s.checked=r>0,s.indeterminate=r>0&&r<t,wfu_browser_store_selector(e,a)},wfu_browser_reload=function(e,a){var t=GlobalData.WFUB[e],r=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/:.*$/,""),s=document.getElementById("wfu_browsernav_"+e+"_pages"),o=0;s&&(o=s.selectedIndex+1);var l="";if(t.reload_on_update&&t.paginated){var n=wfu_browser_apply_server_search_filters(e);l=JSON.stringify(n)}var i=null;if(window["wfu_browser_reload_xhr_"+e]&&null!=(i=window["wfu_browser_reload_xhr_"+e])&&i.abort(),null!=(i=wfu_GetHttpRequestObject())){window["wfu_browser_reload_xhr_"+e]=i;var _=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_browser_reload",params[1]=new Array(2),params[1][0]="nonce",params[1][1]=document.getElementById("wfu_browser_nonce_"+e).value,params[2]=new Array(2),params[2][0]="browser",params[2][1]=document.getElementById("wfu_browser_code_"+e).value,params[3]=new Array(2),params[3][0]="page",params[3][1]=o,params[4]=new Array(2),params[4][0]="sort",params[4][1]=r,params[5]=new Array(2),params[5][0]="filters",params[5][1]=l;for(var u="",d=0;d<params.length;d++)u+=(d>0?"&":"")+params[d][0]+"="+encodeURI(params[d][1]);a&&(document.querySelector("#wfu_browser_"+e+"_overlay td").style.verticalAlign="middle",document.getElementById("wfu_browser_"+e+"_overlay").style.display="block"),i.open("POST",_,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){if(a&&(document.getElementById("wfu_browser_"+e+"_overlay").style.display="none"),200==i.status){var t=i.responseText.indexOf("wfu_browser_reload_success:");-1==t&&(t=i.responseText.length),i.responseText.substr(0,t);var r=i.responseText.substr(t+27,i.responseText.length-t-27);""!=r&&wfu_browser_update_html(e,wfu_plugin_decode_string(r))}window["wfu_browser_reload_xhr_"+e]==i&&(window["wfu_browser_reload_xhr_"+e]=null)}},i.send(u)}},wfu_browser_update_html=function(e,a){var t=GlobalData.WFUB[e];document.querySelector(".wfu_browser_tr_template.wfu_browser-"+e).parentNode.innerHTML=a,t.reload_on_update&&t.paginated||wfu_browser_client_search_filters_changed(e),wfu_browser_update_selector_status(e);var r=a.match(/wfu_browser_page\[(.*?)\]/);r&&r[1]&&wfu_browsernav_update(e,null,r[1])},wfu_download_file_frontend=function(e){for(;e&&-1==e.className.indexOf("wfu_browser_tr");)e=e.parentNode;if(!e)return!1;var a=e.className.replace(/.*wfu_browser-/,""),t=e.className.replace(/.*wfu_row-/,"").replace(/ wfu_browser-.*/,""),r=document.querySelector(".wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_data_file_code").value,s=wfu_GetHttpRequestObject();if(null!=s){var o=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_download_file_invoker",params[1]=new Array(2),params[1][0]="file",params[1][1]=r,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=document.getElementById("wfu_browser_nonce_"+a).value,params[3]=new Array(2),params[3][0]="browser",params[3][1]=document.getElementById("wfu_browser_code_"+a).value;for(var l="",n=0;n<params.length;n++)l+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);s.open("POST",o,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var e=s.responseText.indexOf("wfu_ajax_action_download_file_invoker:");-1==e&&(e=s.responseText.length),s.responseText.substr(0,e);var o=s.responseText.substr(e+38,s.responseText.length-e-38);e=o.indexOf(":");var l=o.substr(0,e);if(txt_value=o.substr(e+1,o.length-e-1),"wfu_download_id;"==l.substr(0,16)){var n=l.substr(16),i=document.querySelector(".wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_file_download_container"),_=wfu_decode_array_from_string(txt_value);if(_){if(i.innerHTML=_.html,""!=_.js){var u=document.createElement("SCRIPT");u.type="text/javascript",u.text=_.js,i.appendChild(u)}setTimeout("wfu_download_file_monitor_frontend('"+r+"', "+a+", "+t+", '"+n+"')",100)}}else"not_allowed"==l&&(txt_value=txt_value.trim(),""!=txt_value&&alert(txt_value))}},s.send(l)}},wfu_download_file_monitor_frontend=function(e,a,t,r){var s=wfu_GetHttpRequestObject();if(null!=s){var o=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_download_file_monitor",params[1]=new Array(2),params[1][0]="file",params[1][1]=e,params[2]=new Array(2),params[2][0]="id",params[2][1]=r;for(var l="",n=0;n<params.length;n++)l+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);s.open("POST",o,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var r=s.responseText.indexOf("wfu_ajax_action_download_file_monitor:");-1==r&&(r=s.responseText.length),s.responseText.substr(0,r);var o=s.responseText.substr(r+38,s.responseText.length-r-38);r=o.indexOf(":");var l=o.substr(0,r);txt_value=o.substr(r+1,o.length-r-1),"repeat"!=l?document.querySelector(".wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_file_download_container").innerHTML="":"repeat"==l&&setTimeout("wfu_download_file_monitor_frontend('"+e+"', "+a+", "+t+", '"+txt_value+"')",100)}},s.send(l)}},wfu_delete_file_frontend=function(e,a,t,r){if(t){for(;a&&-1==a.className.indexOf("wfu_browser_tr");)a=a.parentNode;if(!a)return!1;if(!confirm(GlobalData.consts.wfu_browser_deletefile_prompt))return!1;var s=a.className.replace(/.*wfu_row-/,"").replace(/ wfu_browser-.*/,""),o="";o=r?document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_data_file_id").value:document.querySelector(".wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_data_file_code").value}else{if(0==a.length)return!1;if(1==a.length&&!confirm(GlobalData.consts.wfu_browser_deletefile_prompt))return!1;if(a.length>1&&!confirm(GlobalData.consts.wfu_browser_deletefiles_prompt))return!1;s=0,o="list:"+a.join()}GlobalData.WFUB[e];var l=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/:.*$/,""),n=document.getElementById("wfu_browsernav_"+e+"_pages"),i=0;n&&(i=n.selectedIndex+1);var _=wfu_GetHttpRequestObject();if(null!=_){var u=GlobalData.consts.ajax_url;params=new Array(7),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_delete_file",params[1]=new Array(2),params[1][0]="file",params[1][1]=o,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=document.getElementById("wfu_browser_nonce_"+e).value,params[3]=new Array(2),params[3][0]="browser",params[3][1]=document.getElementById("wfu_browser_code_"+e).value,params[4]=new Array(2),params[4][0]="page",params[4][1]=i,params[5]=new Array(2),params[5][0]="sort",params[5][1]=l,params[6]=new Array(2),params[6][0]="remote",params[6][1]=r?"1":"0";for(var d="",c=0;c<params.length;c++)d+=(c>0?"&":"")+params[c][0]+"="+encodeURI(params[c][1]);var f=document.querySelector("#wfu_browser_"+e+'_bulkactions + input[type="button"]');f&&(f.disable=!0);var p=document.querySelector("#wfu_browser_"+e+'_bulkactions + input[type="button"] + img');p&&(p.style.height=jQuery(f).height()+"px",p.style.display="inline"),_.open("POST",u,!0),_.setRequestHeader("Content-type","application/x-www-form-urlencoded"),_.onreadystatechange=function(){if(4==_.readyState){if(200==_.status){var r="wfu_ajax_action_delete_file:",l=_.responseText.indexOf(r);-1==l&&(l=_.responseText.length),_.responseText.substr(0,l);var n=_.responseText.substr(l+r.length,_.responseText.length-l-r.length);r="wfu_browser_html:",-1==(l=n.indexOf(r))&&(l=n.length);for(var i=n.substr(0,l),u=n.substr(l+r.length,n.length-l-r.length),d=i.split(";"),c=[],w=0,m=0;m<d.length;m++){var b=d[m],g="invalid",h=b.split(":");h.length>0&&(b=h[0]),h.length>1&&(g=wfu_plugin_decode_string(h[1])),"invalid"!=g&&w++,c.push({code:b,error:g})}if(0==w)return;wfu_delete_file_process_result(e,t?[o]:a,c,t,s,u)}f&&(f.disabled=!1),p&&(p.style.display="none")}},_.send(d)}},wfu_delete_file_process_result=function(e,a,t,r,s,o){var l=GlobalData.WFUB[e];if(r)""==t[0].error?l.reload_on_update&&l.paginated?""!=o?wfu_browser_update_html(e,wfu_plugin_decode_string(o)):alert(GlobalData.consts.wfu_browser_deletefile_failed):wfu_browser_delete_file(e,s):"fail:"==t[0].error.substr(0,5)?alert(GlobalData.consts.wfu_browser_deletefile_failed):"not_allowed:"==t[0].error.substr(0,12)?alert(GlobalData.consts.wfu_browser_deletefile_notallowed):"not_allowed_custom:"==t[0].error.substr(0,19)?alert(t[0].error.substr(19)):alert(GlobalData.consts.wfu_browser_deletefile_failed);else{for(var n=0,i=0;i<t.length;i++)""==t[i].error&&n++;""!=o&&wfu_browser_update_html(e,wfu_plugin_decode_string(o)),0==n?alert(GlobalData.consts.wfu_browser_deletefiles_allfailed):n<a.length&&alert(GlobalData.consts.wfu_browser_deletefiles_somefailed)}},wfu_browser_register_search_filter=function(e,a){var t=GlobalData.WFUB[e];if(void 0===a.domain&&(a.domain="client-side"),("server-side"==a.domain||!t.reload_on_update||!t.paginated)&&("server-side"!=a.domain||t.reload_on_update&&t.paginated)&&"function"==typeof a.apply_filter){window["wfu_browser_search_filters_"+e]||(window["wfu_browser_search_filters_"+e]=[]),a.browser_id=e,a.priority||(a.priority=1),a.filter_id=-1;for(var r=0;r<window["wfu_browser_search_filters_"+e].length;r++)if(window["wfu_browser_search_filters_"+e][r].priority>a.priority){window["wfu_browser_search_filters_"+e].splice(r,0,a),a.filter_id=r;break}-1==a.filter_id&&(window["wfu_browser_search_filters_"+e].push(a),a.filter_id=window["wfu_browser_search_filters_"+e].length-1)}},wfu_browser_apply_client_search_filters=function(e,a){if(!window["wfu_browser_search_filters_"+e])return a;for(var t=0;t<window["wfu_browser_search_filters_"+e].length;t++)a=window["wfu_browser_search_filters_"+e][t].apply_filter(a);return a},wfu_browser_apply_server_search_filters=function(e){var a=[];if(!window["wfu_browser_search_filters_"+e])return a;for(var t=0;t<window["wfu_browser_search_filters_"+e].length;t++)a.push(window["wfu_browser_search_filters_"+e][t].apply_filter(null));return a},wfu_browser_client_search_filters_changed=function(e){if(window["wfu_browser_search_filters_"+e]&&window["wfu_browser_search_filters_"+e].length>0){var a=wfu_get_browser_fileprops(e);a=wfu_browser_apply_client_search_filters(e,a),wfu_browsernav_update(e,a),wfu_browser_apply_fileprops(e,a)}},wfu_browser_server_search_filters_changed=function(e){window["wfu_browser_search_filters_"+e]&&window["wfu_browser_search_filters_"+e].length>0&&wfu_browser_reload(e,!0)},wfu_browser_search_filters_changed=function(e){var a=GlobalData.WFUB[e];a.reload_on_update&&a.paginated?wfu_browser_server_search_filters_changed(e):wfu_browser_client_search_filters_changed(e)},wfu_initialize_webcam=function(e,a,t,r,s,o,l,n,i){"undefined"==typeof wfu_parse_video_width&&(wfu_parse_video_width=function(e){var a=parseInt(e);a>0&&(this.empty=!1,this.video.width={ideal:a})}),"undefined"==typeof wfu_parse_video_height&&(wfu_parse_video_height=function(e){var a=parseInt(e);a>0&&(this.empty=!1,this.video.height={ideal:a})}),"undefined"==typeof wfu_parse_video_aspectratio&&(wfu_parse_video_aspectratio=function(e){var a=parseFloat(e);a>0&&(this.empty=!1,this.video.aspectRatio=a)}),"undefined"==typeof wfu_parse_video_framerate&&(wfu_parse_video_framerate=function(e){var a=parseFloat(e);a>0&&(this.empty=!1,this.video.frameRate=a)}),"undefined"==typeof wfu_parse_video_facingmode&&(wfu_parse_video_facingmode=function(e){var a="front"==e?"user":"back"==e?"environment":"";""!=a&&(this.empty=!1,this.video.facingMode=a)});var _={empty:!0,video:{}};wfu_parse_video_width.call(_,r),wfu_parse_video_height.call(_,s),wfu_parse_video_aspectratio.call(_,o),wfu_parse_video_framerate.call(_,l),wfu_parse_video_facingmode.call(_,n);var u={mode:a,audio:"true"==t,video:!!_.empty||_.video,maxrecordtime:i};GlobalData.WFU[e].webcamProps=u,wfu_reinitialize_webcam(e)},wfu_reinitialize_webcam=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.active=!0,t.width=0,t.height=0,t.timeStart=0,t.duration=0,t.counting=!1,t.stream=null,t.media=null,t.blobs=null,t.playing=!1;var r=t;a.updateStatus("idle");var s={audio:r.audio,video:r.video};"undefined"==typeof Promise&&(Promise=function(e){this.mainCallback=e,this.then=function(e){return this.successCallback=e,this},this.catch=function(a){e(this.successCallback,a)}},PromiseRejected=function(e){this.then=function(e){return this},this.catch=function(a){a(e)}},Promise.reject=function(e){return new PromiseRejected(e)}),void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e,a,t){var r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return r&&"undefined"!=typeof MediaRecorder?new Promise((function(a,t){r.call(navigator,e,a,t)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia(s).then((function(s){t.stream=s,a.setVideoProperties({autoplay:!0,ontimeupdate:null,onerror:null,onloadeddata:function(a){wfu_webcam_init_callback(e)},srcObject:s}),a.initButtons(r.mode)})).catch((function(e){console.log("Video not supported!",e),a.updateStatus("video_notsupported")}))},wfu_webcam_init_callback=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps,r=a.videoSize();t.width=r.width,t.height=r.height,a.initCallback()},wfu_webcam_counter_status=function(e,a){var t=GlobalData.WFU[e].webcamProps;if("start"==a){var r=new Date;t.duration=0,t.timeStart=r.getTime()/1e3,t.counting=!0,wfu_webcam_update_counter(e)}else r=new Date,t.duration=r.getTime()/1e3-t.timeStart,t.counting=!1},wfu_webcam_update_counter=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;if(t.counting){var r=(new Date).getTime()/1e3-t.timeStart;a.updateTimer(r),setTimeout((function(){wfu_webcam_update_counter(e)}),100)}},wfu_webcam_video_devices=function(e){return GlobalData.WFU[e].webcamProps,navigator.mediaDevices?.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((e=>{var a=[];return e.forEach((e=>{"videoinput"==e.kind&&a.push(e.deviceId)})),0==a.length&&(a=null),a})).catch((e=>(console.error(`${e.name}: ${e.message}`),null))):new Promise((e=>e(null)))},wfu_webcam_switch_devices=function(e){var a=GlobalData.WFU[e].webcamProps;!0===a.video&&(a.video={}),wfu_webcam_video_devices(e).then((t=>{if(null!=t&&t.length>0){if(a.videoDeviceId){var r=t.indexOf(a.videoDeviceId)+1;r>=t.length&&(r=0),a.videoDeviceId=t[r]}else a.videoDeviceId=t[0];a.video.deviceId=a.videoDeviceId,wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)}else wfu_webcam_switch(e)}))},wfu_webcam_switch=function(e){var a=GlobalData.WFU[e].webcamProps;!0===a.video&&(a.video={});var t=null;a.video.facingMode&&(t=a.video.facingMode),a.video.facingMode="environment"==t?"user":"environment",wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)},wfu_webcam_reset_stream=function(e){var a=GlobalData.WFU[e].webcamProps;null!=a.stream&&a.stream.getTracks&&a.stream.getTracks().forEach((function(e){e.stop()}))},wfu_webcam_onoff=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.active?(a.updateStatus("off"),wfu_webcam_reset_stream(e),t.stream=null,t.media=null,t.blobs=null,t.active=!1):(wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)),wfu_selectbutton_clicked(e)},wfu_webcam_golive=function(e){GlobalData.WFU[e].webcamProps.playing||(wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e),wfu_add_files(e,[],!1),wfu_selectbutton_clicked(e),wfu_update_uploadbutton_status(e))},wfu_webcam_start_rec=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;if(!t.media||!t.media.state||"recording"!=t.media.state){var r=wfu_mediarecorder_mimetype(e);if(null!=r){try{t.media=new MediaRecorder(t.stream,{mimeType:r})}catch(e){return void alert(GlobalData.consts.webcam_video_notsupported)}t.blobs=[],t.media.ondataavailable=function(a){var r=(new Date).getTime()/1e3-t.timeStart;-1==t.maxrecordtime||t.maxrecordtime>0&&r<=t.maxrecordtime?a.data&&a.data.size>0&&t.blobs.push(a.data):wfu_webcam_stop_rec(e)},a.updateButtonStatus("recording"),wfu_webcam_counter_status(e,"start"),t.media.onstop=function(t){wfu_webcam_counter_status(e,"stop"),a.updateButtonStatus("after_recording"),wfu_webcam_onstop(t,e)},t.media.start(10)}else alert(GlobalData.consts.webcam_video_notsupported)}},wfu_webcam_stop_rec=function(e){GlobalData.WFU[e].webcamProps.media.stop()},wfu_webcam_onstop=function(e,a){var t=GlobalData.WFU[a].webcam,r=GlobalData.WFU[a].webcamProps;if(0==r.blobs.length)alert(GlobalData.consts.webcam_video_nothingrecorded),wfu_webcam_golive(a);else{r.stream&&t.screenshot();var s=new Blob(r.blobs,{type:"video/mp4"});t.setVideoProperties({autoplay:!!/iPad|iPhone|iPod/.test(navigator.userAgent),ontimeupdate:function(e){wfu_webcam_update_pos(a)},onended:function(e){wfu_webcam_ended(a)},onloadeddata:function(e){wfu_webcam_pause(a),t.readyState()>=2&&t.updateButtonStatus("ready_playback")},onerror:function(e){t.setVideoProperties({onloadeddata:null,srcObject:r.stream})},srcObject:s}),s.name="videostream.mp4",s.isBlob=!0,wfu_add_files(a,[{file:s,props:{}}],!1),wfu_update_filename_text(a),wfu_update_filelist(a),wfu_update_uploadbutton_status(a)}},wfu_webcam_play=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.playing||(a.updateButtonStatus("playing"),t.playing=!0,a.play())},wfu_webcam_ended=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.ended(),a.updateButtonStatus("ready_playback"),t.playing=!1},wfu_webcam_pause=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.pause(),a.updateButtonStatus("ready_playback"),t.playing=!1},wfu_webcam_back=function(e){GlobalData.WFU[e].webcam.back()},wfu_webcam_fwd=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.fwd(t.duration)},wfu_webcam_update_preview=function(e){if(GlobalData.WFU[1].webcam_exist){var a=wfu_get_filelist(e);0!=a&&GlobalData.WFU[1].webcam.updateImage(a[0])}},wfu_webcam_take_picture=function(e){var a=GlobalData.WFU[e].webcam;GlobalData.WFU[e].webcamProps.stream&&(a.screenshot((function(a){a.name="screenshot.png",a.isBlob=!0,wfu_add_files(e,[{file:a,props:{}}],!1),wfu_update_filename_text(e),wfu_update_filelist(e),wfu_update_uploadbutton_status(e)}),"image/png"),a.updateButtonStatus("after_screenshot"))},wfu_webcam_screenshot_error=function(e){GlobalData.WFU[e].webcam.initButtons(GlobalData.WFU[e].webcamProps.mode)},wfu_webcam_update_pos=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.updatePlayProgress(t.duration),a.updateTimer()},wfu_webcam_init_svginjector=function(){!function(e,a){"use strict";var t="file:"===e.location.protocol,r=a.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),s=Array.prototype.forEach||function(e,a){if(null==this||"function"!=typeof e)throw new TypeError;var t,r=this.length>>>0;for(t=0;r>t;++t)t in this&&e.call(a,this[t],t,this)},o={},l=0,n=[],i=[],_={},u=function(e){return e.cloneNode(!0)},d=function(e,a){i[e]=i[e]||[],i[e].push(a)},c=function(a,r){if(void 0!==o[a])o[a]instanceof SVGSVGElement?r(u(o[a])):d(a,r);else{if(!e.XMLHttpRequest)return r("Browser does not support XMLHttpRequest"),!1;o[a]={},d(a,r);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){if(404===s.status||null===s.responseXML)return r("Unable to load SVG file: "+a),t&&r("Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver."),r(),!1;if(!(200===s.status||t&&0===s.status))return r("There was a problem injecting the SVG: "+s.status+" "+s.statusText),!1;if(s.responseXML instanceof Document)o[a]=s.responseXML.documentElement;else if(DOMParser&&DOMParser instanceof Function){var e;try{e=(new DOMParser).parseFromString(s.responseText,"text/xml")}catch(a){e=void 0}if(!e||e.getElementsByTagName("parsererror").length)return r("Unable to parse SVG file: "+a),!1;o[a]=e.documentElement}!function(e){for(var a=0,t=i[e].length;t>a;a++)!function(a){setTimeout((function(){i[e][a](u(o[e]))}),0)}(a)}(a)}},s.open("GET",a),s.overrideMimeType&&s.overrideMimeType("text/xml"),s.send()}},f=function(a,t,o,i){var u=a.getAttribute("data-src")||a.getAttribute("src");if(/\.svg/i.test(u))if(r)-1===n.indexOf(a)&&(n.push(a),a.setAttribute("src",""),c(u,(function(r){if(void 0===r||"string"==typeof r)return i(r),!1;var o=a.getAttribute("id");o&&r.setAttribute("id",o);var d=a.getAttribute("title");d&&r.setAttribute("title",d);var c=[].concat(r.getAttribute("class")||[],"injected-svg",a.getAttribute("class")||[]).join(" ");r.setAttribute("class",function(e){for(var a={},t=(e=e.split(" ")).length,r=[];t--;)a.hasOwnProperty(e[t])||(a[e[t]]=1,r.unshift(e[t]));return r.join(" ")}(c));var f=a.getAttribute("style");f&&r.setAttribute("style",f);var p=[].filter.call(a.attributes,(function(e){return/^data-\w[\w\-]*$/.test(e.name)}));s.call(p,(function(e){e.name&&e.value&&r.setAttribute(e.name,e.value)}));var w,m,b,g,h,v={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(v).forEach((function(e){w=e,b=v[e];for(var a=0,t=(m=r.querySelectorAll("defs "+w+"[id]")).length;t>a;a++){var o;g=m[a].id,h=g+"-"+l,s.call(b,(function(e){for(var a=0,t=(o=r.querySelectorAll("["+e+'*="'+g+'"]')).length;t>a;a++)o[a].setAttribute(e,"url(#"+h+")")})),m[a].id=h}})),r.removeAttribute("xmlns:a");for(var y,G,x=r.querySelectorAll("script"),D=[],k=0,U=x.length;U>k;k++)(G=x[k].getAttribute("type"))&&"application/ecmascript"!==G&&"application/javascript"!==G||(y=x[k].innerText||x[k].textContent,D.push(y),r.removeChild(x[k]));if(D.length>0&&("always"===t||"once"===t&&!_[u])){for(var F=0,P=D.length;P>F;F++)new Function(D[F])(e);_[u]=!0}var C=r.querySelectorAll("style");s.call(C,(function(e){e.textContent+=""})),a.parentNode.replaceChild(r,a),delete n[n.indexOf(a)],a=null,l++,i(r)})));else{var d=a.getAttribute("data-fallback")||a.getAttribute("data-png");d?(a.setAttribute("src",d),i(null)):o?(a.setAttribute("src",o+"/"+u.split("/").pop().replace(".svg",".png")),i(null)):i("This browser does not support SVG and no PNG fallback was defined.")}else i("Attempted to inject a file with a non-svg extension: "+u)},p=function(e,a,t){var r=(a=a||{}).evalScripts||"always",o=a.pngFallback||!1,l=a.each;if(void 0!==e.length){var n=0;s.call(e,(function(a){f(a,r,o,(function(a){l&&"function"==typeof l&&l(a),t&&e.length===++n&&t(n)}))}))}else e?f(e,r,o,(function(a){l&&"function"==typeof l&&l(a),t&&t(1),e=null})):t&&t(0)};"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=p:"function"==typeof define&&define.amd?define((function(){return p})):"object"==typeof e&&(e.SVGInjector=p)}(window,document)},wfu_webcam_initialize_toBlob=function(){!function(e){"use strict";var a=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,t=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=t&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,l=(t||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var a,l,n,i,_,u,d,c,f;if(!(a=e.match(o)))throw new Error("invalid data URI");for(l=a[2]?a[1]:"text/plain"+(a[3]||";charset=US-ASCII"),n=!!a[4],i=e.slice(a[0].length),_=n?atob(i):decodeURIComponent(i),u=new ArrayBuffer(_.length),d=new Uint8Array(u),c=0;c<_.length;c+=1)d[c]=_.charCodeAt(c);return t?new Blob([r?d:u],{type:l}):((f=new s).append(u),f.getBlob(l))};e.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(e,t,r){e(r&&a.toDataURL&&l?l(this.toDataURL(t,r)):this.mozGetAsFile("blob",t))}:a.toDataURL&&l&&(a.toBlob=function(e,a,t){e(l(this.toDataURL(a,t)))})),"function"==typeof define&&define.amd?define((function(){return l})):"object"==typeof module&&module.exports?module.exports=l:e.dataURLtoBlob=l}(window),window.wfu_toBlob_function_initialized=!0},wfu_mediarecorder_mimetype=function(e){var a=["webm","mp4","x-matroska","ogg"],t=["vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h.265","h264","h.264","mpeg","theora"],r=["opus","vorbis","aac","mpeg","mp4a","pcm"],s=GlobalData.WFU[e].webcamProps,o=null;if(""!=GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype&&MediaRecorder.isTypeSupported(GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype))return GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype;if(!0===s.audio)for(var l=0;l<a.length;++l){for(var n=a[l],i=0;i<t.length;++i){for(var _=t[i],u=0;u<r.length;++u){var d=`video/${n};codecs=${_},${r[u]}`;if(MediaRecorder.isTypeSupported(d)){o=d;break}}if(null!=o)break}if(null!=o)break}else for(l=0;l<a.length;++l){for(n=a[l],i=0;i<t.length;++i)if(d=`video/${n};codecs=${_=t[i]}`,MediaRecorder.isTypeSupported(d)){o=d;break}if(null!=o)break}return o},wfu_run_js_from_bank();
