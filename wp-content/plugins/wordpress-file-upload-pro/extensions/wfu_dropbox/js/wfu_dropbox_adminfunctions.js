function wfu_dropbox_authorize_app_start(e){var a=wfu_GetHttpRequestObject();if(null!=a){var r=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_dropbox_authorize_app_start",params[1]=new Array(2),params[1][0]="token",params[1][1]=e;for(var t="",s=0;s<params.length;s++)t+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);a.open("POST",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.indexOf("wfu_dropbox_authorize_app_start:");-1==e&&(e=a.responseText.length),a.responseText.substr(0,e);var r=a.responseText.substr(e+32,a.responseText.length-e-32);e=r.indexOf(":");var t=r.substr(0,e);if(txt_value=r.substr(e+1,r.length-e-1),"success"==t){var s=window.open(wfu_plugin_decode_string(txt_value),"_blank");s?s.plugin_window=window:alert("Please enable popup windows from the browser's settings!")}else"error"==t&&console.log("Dropbox application authorization error: "+txt_value)}},a.send(t)}}function wfu_dropbox_authorize_app_finish(e){var a=document.getElementById("wfu_dropbox_authorization_code").value;if(""!=a.trim()){var r=wfu_GetHttpRequestObject();if(null!=r){var t=AdminParams.wfu_ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_dropbox_authorize_app_finish",params[1]=new Array(2),params[1][0]="token",params[1][1]=e,params[2]=new Array(2),params[2][0]="authcode",params[2][1]=a;for(var s="",n=0;n<params.length;n++)s+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);r.open("POST",t,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=r.responseText.indexOf("wfu_dropbox_authorize_app_finish:");-1==e&&(e=r.responseText.length),r.responseText.substr(0,e);var a=r.responseText.substr(e+33,r.responseText.length-e-33);e=a.indexOf(":");var t=a.substr(0,e);txt_value=a.substr(e+1,a.length-e-1),"success"==t?document.getElementById("editsettings").submit():"error"==t&&console.log("Dropbox application authorization error: "+txt_value)}},r.send(s)}}}function wfu_dropbox_authorize_app_reset(e){var a=wfu_GetHttpRequestObject();if(null!=a){var r=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_dropbox_authorize_app_reset",params[1]=new Array(2),params[1][0]="token",params[1][1]=e;for(var t="",s=0;s<params.length;s++)t+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);a.open("POST",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.indexOf("wfu_dropbox_authorize_app_reset:");-1==e&&(e=a.responseText.length),a.responseText.substr(0,e);var r=a.responseText.substr(e+32,a.responseText.length-e-32);e=r.indexOf(":");var t=r.substr(0,e);txt_value=r.substr(e+1,r.length-e-1),"success"==t?document.getElementById("editsettings").submit():"error"==t&&console.log("Dropbox application authorization error: "+txt_value)}},a.send(t)}}function wfu_dropbox_send_file(e,a){var r=wfu_GetHttpRequestObject();if(null!=r){var t="",s=document.getElementById("wfu_dropbox_transfer_nonce");if(s&&(t=s.value),""!=t){var n=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(3),params[0][0]="action",params[0][1]="wfu_ajax_action_dropbox_add_file",params[1]=new Array(2),params[1][0]="file",params[1][1]=e,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=t;for(var o="",p=0;p<params.length;p++)o+=(p>0?"&":"")+params[p][0]+"="+encodeURI(params[p][1]);document.getElementById("wfu_send_to_dropbox_"+a+"_a").href="javascript: void(0)",document.getElementById("wfu_send_to_dropbox_"+a+"_img").style.display="inline",r.open("POST",n,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState&&(document.getElementById("wfu_send_to_dropbox_"+a+"_img").style.display="none",200==r.status)){var e=r.responseText.indexOf("wfu_dropbox_add_file:");-1==e&&(e=r.responseText.length),r.responseText.substr(0,e);var t=r.responseText.substr(e+21,r.responseText.length-e-21);e=t.indexOf(":");var s=t.substr(0,e);txt_value=t.substr(e+1,t.length-e-1),document.getElementById("wfu_send_to_dropbox_"+a+"_a").innerHTML="success"==s?document.getElementById("wfu_send_to_dropbox_"+a+"_inpok").value:document.getElementById("wfu_send_to_dropbox_"+a+"_inpfail").value}},r.send(o)}}}
