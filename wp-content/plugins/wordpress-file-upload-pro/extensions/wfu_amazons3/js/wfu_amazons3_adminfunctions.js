function wfu_amazons3_authorize_app_start(e){document.querySelector(".wfu-amazons3-activation").classList.add("activating");var a=document.querySelector(".wfu-amazons3-activation .not-activated");a.innerHTML=a.getAttribute("data-activating")}function wfu_amazons3_authorize_app_finish(e){var a=document.querySelector(".wfu-amazons3-keys .publickey").value,t=document.querySelector(".wfu-amazons3-keys .privatekey").value;if(""!=a.trim()&&""!=t.trim()){var s=wfu_GetHttpRequestObject();if(null!=s){var n=AdminParams.wfu_ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_amazons3_authorize_app_finish",params[1]=new Array(2),params[1][0]="publickey",params[1][1]=a,params[2]=new Array(2),params[2][0]="privatekey",params[2][1]=t,params[3]=new Array(2),params[3][0]="nonce",params[3][1]=e;for(var r="",o=0;o<params.length;o++)r+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);document.querySelector(".wfu-amazons3-keys button").disabled=!0,document.querySelector(".wfu-amazons3-keys .error-message").classList.remove("visible"),s.open("POST",n,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){document.querySelector(".wfu-amazons3-keys button").disabled=!1;var e=s.responseText.indexOf("wfu_amazons3_authorize_app_finish:");-1==e&&(e=s.responseText.length),s.responseText.substr(0,e);var a=s.responseText.substr(e+34,s.responseText.length-e-34);"success"==a?document.getElementById("editsettings").submit():(document.querySelector(".wfu-amazons3-keys .error-message").innerHTML=a,document.querySelector(".wfu-amazons3-keys .error-message").classList.add("visible"),console.log("Amazon S3 application authorization error: "+a))}},s.send(r)}}}function wfu_amazons3_authorize_app_reset(e){var a=wfu_GetHttpRequestObject();if(null!=a){var t=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_amazons3_authorize_app_reset",params[1]=new Array(2),params[1][0]="nonce",params[1][1]=e;for(var s="",n=0;n<params.length;n++)s+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);a.open("POST",t,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.indexOf("wfu_amazons3_authorize_app_reset:");-1==e&&(e=a.responseText.length),a.responseText.substr(0,e);var t=a.responseText.substr(e+33,a.responseText.length-e-33);"success"==t?document.getElementById("editsettings").submit():console.log("Amazon S3 application authorization reset error: "+t)}},a.send(s)}}function wfu_amazons3_send_file(e,a){var t=wfu_GetHttpRequestObject();if(null!=t){var s="",n=document.getElementById("wfu_amazons3_transfer_nonce");if(n&&(s=n.value),""!=s){var r=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(3),params[0][0]="action",params[0][1]="wfu_ajax_action_amazons3_add_file",params[1]=new Array(2),params[1][0]="file",params[1][1]=e,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=s;for(var o="",u=0;u<params.length;u++)o+=(u>0?"&":"")+params[u][0]+"="+encodeURI(params[u][1]);document.getElementById("wfu_send_to_amazons3_"+a+"_a").href="javascript: void(0)",document.getElementById("wfu_send_to_amazons3_"+a+"_img").style.display="inline",t.open("POST",r,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState&&(document.getElementById("wfu_send_to_amazons3_"+a+"_img").style.display="none",200==t.status)){var e=t.responseText.indexOf("wfu_amazons3_add_file:");-1==e&&(e=t.responseText.length),t.responseText.substr(0,e);var s=t.responseText.substr(e+22,t.responseText.length-e-22);e=s.indexOf(":");var n=s.substr(0,e);txt_value=s.substr(e+1,s.length-e-1),document.getElementById("wfu_send_to_amazons3_"+a+"_a").innerHTML="success"==n?document.getElementById("wfu_send_to_amazons3_"+a+"_inpok").value:document.getElementById("wfu_send_to_amazons3_"+a+"_inpfail").value}},t.send(o)}}}
