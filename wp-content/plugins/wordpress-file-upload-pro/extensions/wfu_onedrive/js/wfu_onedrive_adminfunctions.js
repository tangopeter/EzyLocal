function wfu_onedrive_authorize_app_start(e){var a=wfu_GetHttpRequestObject();if(null!=a){var r=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_onedrive_authorize_app_start",params[1]=new Array(2),params[1][0]="token",params[1][1]=e;for(var t="",n=0;n<params.length;n++)t+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);a.open("POST",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.indexOf("wfu_onedrive_authorize_app_start:");-1==e&&(e=a.responseText.length),a.responseText.substr(0,e);var r=a.responseText.substr(e+33,a.responseText.length-e-33);e=r.indexOf(":");var t=r.substr(0,e);if(txt_value=r.substr(e+1,r.length-e-1),"success"==t){var n=window.open(wfu_plugin_decode_string(txt_value),"_blank");n?n.plugin_window=window:alert("Please enable popup windows from the browser's settings!")}else"error"==t&&console.log("Microsoft OneDrive application authorization error: "+txt_value)}},a.send(t)}}function wfu_onedrive_authorize_app_finish(e){var a=document.getElementById("wfu_onedrive_authorization_code").value;if(""!=a.trim()){var r=wfu_GetHttpRequestObject();if(null!=r){var t=AdminParams.wfu_ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_onedrive_authorize_app_finish",params[1]=new Array(2),params[1][0]="token",params[1][1]=e,params[2]=new Array(2),params[2][0]="authcode",params[2][1]=a;for(var n="",s=0;s<params.length;s++)n+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);r.open("POST",t,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=r.responseText.indexOf("wfu_onedrive_authorize_app_finish:");-1==e&&(e=r.responseText.length),r.responseText.substr(0,e);var a=r.responseText.substr(e+34,r.responseText.length-e-34);e=a.indexOf(":");var t=a.substr(0,e);txt_value=a.substr(e+1,a.length-e-1),"success"==t?document.getElementById("editsettings").submit():"error"==t&&console.log("Microsoft OneDrive application authorization error: "+txt_value)}},r.send(n)}}}function wfu_onedrive_authorize_app_reset(e){var a=wfu_GetHttpRequestObject();if(null!=a){var r=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_onedrive_authorize_app_reset",params[1]=new Array(2),params[1][0]="token",params[1][1]=e;for(var t="",n=0;n<params.length;n++)t+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);a.open("POST",r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.indexOf("wfu_onedrive_authorize_app_reset:");-1==e&&(e=a.responseText.length),a.responseText.substr(0,e);var r=a.responseText.substr(e+33,a.responseText.length-e-33);e=r.indexOf(":");var t=r.substr(0,e);txt_value=r.substr(e+1,r.length-e-1),"success"==t?document.getElementById("editsettings").submit():"error"==t&&console.log("Microsoft OneDrive application authorization error: "+txt_value)}},a.send(t)}}function wfu_onedrive_send_file(e,a){var r=wfu_GetHttpRequestObject();if(null!=r){var t="",n=document.getElementById("wfu_onedrive_transfer_nonce");if(n&&(t=n.value),""!=t){var s=AdminParams.wfu_ajax_url;params=new Array(2),params[0]=new Array(3),params[0][0]="action",params[0][1]="wfu_ajax_action_onedrive_add_file",params[1]=new Array(2),params[1][0]="file",params[1][1]=e,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=t;for(var o="",i=0;i<params.length;i++)o+=(i>0?"&":"")+params[i][0]+"="+encodeURI(params[i][1]);document.getElementById("wfu_send_to_onedrive_"+a+"_a").href="javascript: void(0)",document.getElementById("wfu_send_to_onedrive_"+a+"_img").style.display="inline",r.open("POST",s,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState&&(document.getElementById("wfu_send_to_onedrive_"+a+"_img").style.display="none",200==r.status)){var e=r.responseText.indexOf("wfu_onedrive_add_file:");-1==e&&(e=r.responseText.length),r.responseText.substr(0,e);var t=r.responseText.substr(e+22,r.responseText.length-e-22);e=t.indexOf(":");var n=t.substr(0,e);txt_value=t.substr(e+1,t.length-e-1),document.getElementById("wfu_send_to_onedrive_"+a+"_a").innerHTML="success"==n?document.getElementById("wfu_send_to_onedrive_"+a+"_inpok").value:document.getElementById("wfu_send_to_onedrive_"+a+"_inpfail").value}},r.send(o)}}}
